        -:    0:Source:/home/workspace/jerry-core/ecma/operations/ecma-function-object.c
        -:    0:Programs:299
        -:    1:/* Copyright JS Foundation and other contributors, http://js.foundation
        -:    2: *
        -:    3: * Licensed under the Apache License, Version 2.0 (the "License");
        -:    4: * you may not use this file except in compliance with the License.
        -:    5: * You may obtain a copy of the License at
        -:    6: *
        -:    7: *     http://www.apache.org/licenses/LICENSE-2.0
        -:    8: *
        -:    9: * Unless required by applicable law or agreed to in writing, software
        -:   10: * distributed under the License is distributed on an "AS IS" BASIS
        -:   11: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        -:   12: * See the License for the specific language governing permissions and
        -:   13: * limitations under the License.
        -:   14: */
        -:   15:
        -:   16:#include "ecma-function-object.h"
        -:   17:
        -:   18:#include "ecma-alloc.h"
        -:   19:#include "ecma-builtin-handlers.h"
        -:   20:#include "ecma-builtin-helpers.h"
        -:   21:#include "ecma-errors.h"
        -:   22:#include "ecma-exceptions.h"
        -:   23:#include "ecma-extended-info.h"
        -:   24:#include "ecma-gc.h"
        -:   25:#include "ecma-helpers.h"
        -:   26:#include "ecma-lex-env.h"
        -:   27:#include "ecma-objects-general.h"
        -:   28:#include "ecma-objects.h"
        -:   29:#include "ecma-promise-object.h"
        -:   30:#include "ecma-proxy-object.h"
        -:   31:#include "ecma-symbol-object.h"
        -:   32:
        -:   33:#include "jcontext.h"
        -:   34:#include "lit-char-helpers.h"
        -:   35:#include "opcodes.h"
        -:   36:
        -:   37:/** \addtogroup ecma ECMA
        -:   38: * @{
        -:   39: *
        -:   40: * \addtogroup ecmafunctionobject ECMA Function object related routines
        -:   41: * @{
        -:   42: */
        -:   43:
        -:   44:#if JERRY_ESNEXT
        -:   45:/**
        -:   46: * SetFunctionName operation
        -:   47: *
        -:   48: * See also: ECMAScript v6, 9.2.1.1
        -:   49: *
        -:   50: * @return source name as ecma-string
        -:   51: */
        -:   52:ecma_value_t
        9:   53:ecma_op_function_form_name (ecma_string_t *prop_name_p, /**< property name */
        -:   54:                            char *prefix_p, /**< prefix */
        -:   55:                            lit_utf8_size_t prefix_size) /**< prefix length */
        -:   56:{
        -:   57:  /* 4. */
        9:   58:  if (ecma_prop_name_is_symbol (prop_name_p))
        -:   59:  {
        -:   60:    /* .a */
    #####:   61:    ecma_value_t string_desc = ecma_get_symbol_description (prop_name_p);
        -:   62:
        -:   63:    /* .b */
    #####:   64:    if (ecma_is_value_undefined (string_desc))
        -:   65:    {
    #####:   66:      prop_name_p = ecma_get_magic_string (LIT_MAGIC_STRING__EMPTY);
        -:   67:    }
        -:   68:    /* .c */
        -:   69:    else
        -:   70:    {
    #####:   71:      ecma_string_t *string_desc_p = ecma_get_string_from_value (string_desc);
    #####:   72:      ecma_stringbuilder_t builder = ecma_stringbuilder_create_raw ((lit_utf8_byte_t *) "[", 1);
    #####:   73:      ecma_stringbuilder_append (&builder, string_desc_p);
    #####:   74:      ecma_stringbuilder_append_byte (&builder, (lit_utf8_byte_t) LIT_CHAR_RIGHT_SQUARE);
    #####:   75:      prop_name_p = ecma_stringbuilder_finalize (&builder);
        -:   76:    }
        -:   77:  }
        -:   78:  else
        -:   79:  {
        9:   80:    ecma_ref_ecma_string (prop_name_p);
        -:   81:  }
        -:   82:
        -:   83:  /* 5. */
        9:   84:  if (JERRY_UNLIKELY (prefix_p != NULL))
        -:   85:  {
    #####:   86:    ecma_stringbuilder_t builder = ecma_stringbuilder_create_raw ((lit_utf8_byte_t *) prefix_p, prefix_size);
    #####:   87:    ecma_stringbuilder_append (&builder, prop_name_p);
    #####:   88:    ecma_deref_ecma_string (prop_name_p);
    #####:   89:    prop_name_p = ecma_stringbuilder_finalize (&builder);
        -:   90:  }
        -:   91:
        9:   92:  return ecma_make_string_value (prop_name_p);
        -:   93:} /* ecma_op_function_form_name */
        -:   94:#endif /* JERRY_ESNEXT */
        -:   95:
        -:   96:#if JERRY_BUILTIN_PROXY
        -:   97:/**
        -:   98: * IsCallable operation for proxy object.
        -:   99: *
        -:  100: * @return true - if the given proxy object is callable;
        -:  101: *         false - otherwise
        -:  102: */
        -:  103:extern inline bool JERRY_ATTR_ALWAYS_INLINE
    #####:  104:ecma_op_proxy_object_is_callable (ecma_object_t *obj_p) /**< ecma object */
        -:  105:{
    #####:  106:  JERRY_ASSERT (!ecma_is_lexical_environment (obj_p));
    #####:  107:  JERRY_ASSERT (ECMA_OBJECT_IS_PROXY (obj_p));
        -:  108:
    #####:  109:  return (obj_p->u2.prototype_cp & ECMA_PROXY_IS_CALLABLE) != 0;
        -:  110:} /* ecma_op_proxy_object_is_callable */
        -:  111:#endif /* JERRY_BUILTIN_PROXY */
        -:  112:
        -:  113:/**
        -:  114: * IsCallable operation.
        -:  115: *
        -:  116: * See also: ECMA-262 v5, 9.11
        -:  117: *
        -:  118: * @return true - if the given object is callable;
        -:  119: *         false - otherwise
        -:  120: */
        -:  121:extern inline bool JERRY_ATTR_ALWAYS_INLINE
    #####:  122:ecma_op_object_is_callable (ecma_object_t *obj_p) /**< ecma object */
        -:  123:{
    #####:  124:  JERRY_ASSERT (!ecma_is_lexical_environment (obj_p));
        -:  125:
    #####:  126:  const ecma_object_type_t type = ecma_get_object_type (obj_p);
        -:  127:
        -:  128:#if JERRY_BUILTIN_PROXY
    #####:  129:  if (ECMA_OBJECT_TYPE_IS_PROXY (type))
        -:  130:  {
    #####:  131:    return ecma_op_proxy_object_is_callable (obj_p);
        -:  132:  }
        -:  133:#endif /* JERRY_BUILTIN_PROXY */
        -:  134:
    #####:  135:  return type >= ECMA_OBJECT_TYPE_FUNCTION;
        -:  136:} /* ecma_op_object_is_callable */
        -:  137:
        -:  138:/**
        -:  139: * IsCallable operation.
        -:  140: *
        -:  141: * See also: ECMA-262 v5, 9.11
        -:  142: *
        -:  143: * @return true - if value is callable object;
        -:  144: *         false - otherwise
        -:  145: */
        -:  146:bool
    #####:  147:ecma_op_is_callable (ecma_value_t value) /**< ecma value */
        -:  148:{
    #####:  149:  return (ecma_is_value_object (value) && ecma_op_object_is_callable (ecma_get_object_from_value (value)));
        -:  150:} /* ecma_op_is_callable */
        -:  151:
        -:  152:/**
        -:  153: * Implement IsConstructor abstract operation.
        -:  154: *
        -:  155: *
        -:  156: * @return ECMA_IS_VALID_CONSTRUCTOR - if object is a valid for constructor call
        -:  157: *         ecma_error_msg_t id of error - otherwise
        -:  158: */
        -:  159:ecma_error_msg_t
       13:  160:ecma_object_check_constructor (ecma_object_t *obj_p) /**< ecma object */
        -:  161:{
       13:  162:  JERRY_ASSERT (!ecma_is_lexical_environment (obj_p));
        -:  163:
       13:  164:  ecma_object_type_t type = ecma_get_object_type (obj_p);
        -:  165:
       13:  166:  if (JERRY_UNLIKELY (type < ECMA_OBJECT_TYPE_PROXY))
        -:  167:  {
    #####:  168:    return ECMA_ERR_INVALID_TYPE_FOR_CONSTRUCTOR_CALL;
        -:  169:  }
        -:  170:
       26:  171:  while (JERRY_UNLIKELY (type == ECMA_OBJECT_TYPE_BOUND_FUNCTION))
        -:  172:  {
    #####:  173:    ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) obj_p;
        -:  174:
    #####:  175:    obj_p =
    #####:  176:      ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, bound_func_p->header.u.bound_function.target_function);
        -:  177:
    #####:  178:    type = ecma_get_object_type (obj_p);
        -:  179:  }
        -:  180:
       13:  181:  if (JERRY_LIKELY (type == ECMA_OBJECT_TYPE_FUNCTION))
        -:  182:  {
        -:  183:#if JERRY_ESNEXT
        5:  184:    const ecma_compiled_code_t *byte_code_p = ecma_op_function_get_compiled_code ((ecma_extended_object_t *) obj_p);
        -:  185:
        5:  186:    if (!CBC_FUNCTION_IS_CONSTRUCTABLE (byte_code_p->status_flags))
        -:  187:    {
        -:  188:#if JERRY_ERROR_MESSAGES
    #####:  189:      switch (CBC_FUNCTION_GET_TYPE (byte_code_p->status_flags))
        -:  190:      {
    #####:  191:        case CBC_FUNCTION_SCRIPT:
        -:  192:        {
    #####:  193:          return ECMA_ERR_SCRIPT_GLOBAL_FUNCTIONS_INVOKE_WITH_NEW;
        -:  194:        }
    #####:  195:        case CBC_FUNCTION_GENERATOR:
        -:  196:        {
    #####:  197:          return ECMA_ERR_GENERATOR_FUNCTIONS_INVOKE_WITH_NEW;
        -:  198:        }
    #####:  199:        case CBC_FUNCTION_ASYNC:
        -:  200:        {
    #####:  201:          return ECMA_ERR_ASYNC_FUNCTIONS_INVOKE_WITH_NEW;
        -:  202:        }
    #####:  203:        case CBC_FUNCTION_ASYNC_GENERATOR:
        -:  204:        {
    #####:  205:          return ECMA_ERR_ASYNC_GENERATOR_FUNCTIONS_INVOKE_WITH_NEW;
        -:  206:        }
    #####:  207:        case CBC_FUNCTION_ACCESSOR:
        -:  208:        {
    #####:  209:          return ECMA_ERR_ACCESSOR_FUNCTIONS_INVOKE_WITH_NEW;
        -:  210:        }
    #####:  211:        case CBC_FUNCTION_METHOD:
        -:  212:        {
    #####:  213:          return ECMA_ERR_METHODS_INVOKE_WITH_NEW;
        -:  214:        }
    #####:  215:        case CBC_FUNCTION_ARROW:
        -:  216:        {
    #####:  217:          return ECMA_ERR_ARROW_FUNCTIONS_INVOKE_WITH_NEW;
        -:  218:        }
    #####:  219:        default:
        -:  220:        {
    #####:  221:          JERRY_ASSERT (CBC_FUNCTION_GET_TYPE (byte_code_p->status_flags) == CBC_FUNCTION_ASYNC_ARROW);
    #####:  222:          return ECMA_ERR_ASYNC_ARROW_FUNCTIONS_INVOKE_WITH_NEW;
        -:  223:        }
        -:  224:      }
        -:  225:#else /* !JERRY_ERROR_MESSAGES */
        -:  226:      return ECMA_ERR_EMPTY;
        -:  227:#endif /* JERRY_ERROR_MESSAGES */
        -:  228:    }
        -:  229:#endif /* JERRY_NEXT */
        -:  230:
        5:  231:    return ECMA_IS_VALID_CONSTRUCTOR;
        -:  232:  }
        -:  233:
        -:  234:#if JERRY_BUILTIN_PROXY
        8:  235:  if (ECMA_OBJECT_TYPE_IS_PROXY (type))
        -:  236:  {
    #####:  237:    if (!(obj_p->u2.prototype_cp & ECMA_PROXY_IS_CONSTRUCTABLE))
        -:  238:    {
    #####:  239:      return ECMA_ERR_PROXY_TARGET_IS_NOT_A_CONSTRUCTOR;
        -:  240:    }
        -:  241:
    #####:  242:    return ECMA_IS_VALID_CONSTRUCTOR;
        -:  243:  }
        -:  244:#endif /* JERRY_BUILTIN_PROXY */
        -:  245:
        8:  246:  JERRY_ASSERT (type == ECMA_OBJECT_TYPE_NATIVE_FUNCTION || type == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION
        -:  247:                || type == ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION);
        -:  248:
        8:  249:  if (type == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION)
        -:  250:  {
    #####:  251:    if (ecma_builtin_function_is_routine (obj_p))
        -:  252:    {
    #####:  253:      return ECMA_ERR_BULTIN_ROUTINES_HAVE_NO_CONSTRUCTOR;
        -:  254:    }
        -:  255:
        -:  256:#if JERRY_ESNEXT
    #####:  257:    JERRY_ASSERT (((ecma_extended_object_t *) obj_p)->u.built_in.id != ECMA_BUILTIN_ID_HANDLER);
        -:  258:#endif /* !JERRY_ESNEXT */
        -:  259:  }
        -:  260:
        8:  261:  return ECMA_IS_VALID_CONSTRUCTOR;
        -:  262:} /* ecma_object_check_constructor */
        -:  263:
        -:  264:/**
        -:  265: * Implement IsConstructor abstract operation.
        -:  266: *
        -:  267: * @return ECMA_IS_VALID_CONSTRUCTOR - if the input value is a constructor.
        -:  268: *         ecma_error_msg_t id of error - otherwise
        -:  269: */
        -:  270:extern inline ecma_error_msg_t JERRY_ATTR_ALWAYS_INLINE
        5:  271:ecma_check_constructor (ecma_value_t value) /**< ecma object */
        -:  272:{
        5:  273:  if (!ecma_is_value_object (value))
        -:  274:  {
    #####:  275:    return ECMA_ERR_INVALID_TYPE_FOR_CONSTRUCTOR_CALL;
        -:  276:  }
        -:  277:
        5:  278:  return ecma_object_check_constructor (ecma_get_object_from_value (value));
        -:  279:} /* ecma_check_constructor */
        -:  280:
        -:  281:/**
        -:  282: * Checks whether the given object implements [[Construct]].
        -:  283: *
        -:  284: * @return true - if the given object is constructor;
        -:  285: *         false - otherwise
        -:  286: */
        -:  287:extern inline bool JERRY_ATTR_ALWAYS_INLINE
    #####:  288:ecma_object_is_constructor (ecma_object_t *obj_p) /**< ecma object */
        -:  289:{
        8:  290:  return ecma_object_check_constructor (obj_p) == ECMA_IS_VALID_CONSTRUCTOR;
        -:  291:} /* ecma_object_is_constructor */
        -:  292:
        -:  293:/**
        -:  294: * Checks whether the value is Object that implements [[Construct]].
        -:  295: *
        -:  296: * @return true - if value is constructor object;
        -:  297: *         false - otherwise
        -:  298: */
        -:  299:bool
        8:  300:ecma_is_constructor (ecma_value_t value) /**< ecma value */
        -:  301:{
       16:  302:  return (ecma_is_value_object (value) && ecma_object_is_constructor (ecma_get_object_from_value (value)));
        -:  303:} /* ecma_is_constructor */
        -:  304:
        -:  305:/**
        -:  306: * Helper method to count and convert the arguments for the Function/GeneratorFunction constructor call.
        -:  307: *
        -:  308: * See also:
        -:  309: *          ECMA 262 v5.1 15.3.2.1 steps 5.a-d
        -:  310: *          ECMA 262 v6 19.2.1.1.1 steps 8
        -:  311: *
        -:  312: * @return ecma value - concatenated arguments as a string.
        -:  313: *         Returned value must be freed with ecma_free_value.
        -:  314: */
        -:  315:static ecma_string_t *
    #####:  316:ecma_op_create_dynamic_function_arguments_helper (const ecma_value_t *arguments_list_p, /**< arguments list */
        -:  317:                                                  uint32_t arguments_list_len) /**< number of arguments */
        -:  318:{
    #####:  319:  JERRY_ASSERT (arguments_list_len == 0 || arguments_list_p != NULL);
        -:  320:
    #####:  321:  if (arguments_list_len <= 1)
        -:  322:  {
    #####:  323:    return ecma_get_magic_string (LIT_MAGIC_STRING__EMPTY);
        -:  324:  }
        -:  325:
    #####:  326:  ecma_string_t *str_p = ecma_op_to_string (arguments_list_p[0]);
        -:  327:
    #####:  328:  if (JERRY_UNLIKELY (str_p == NULL))
        -:  329:  {
    #####:  330:    return str_p;
        -:  331:  }
        -:  332:
    #####:  333:  if (arguments_list_len == 2)
        -:  334:  {
    #####:  335:    return str_p;
        -:  336:  }
        -:  337:
    #####:  338:  ecma_stringbuilder_t builder = ecma_stringbuilder_create_from (str_p);
    #####:  339:  ecma_deref_ecma_string (str_p);
        -:  340:
    #####:  341:  for (uint32_t idx = 1; idx < arguments_list_len - 1; idx++)
        -:  342:  {
    #####:  343:    str_p = ecma_op_to_string (arguments_list_p[idx]);
        -:  344:
    #####:  345:    if (JERRY_UNLIKELY (str_p == NULL))
        -:  346:    {
    #####:  347:      ecma_stringbuilder_destroy (&builder);
    #####:  348:      return str_p;
        -:  349:    }
        -:  350:
    #####:  351:    ecma_stringbuilder_append_char (&builder, LIT_CHAR_COMMA);
    #####:  352:    ecma_stringbuilder_append (&builder, str_p);
    #####:  353:    ecma_deref_ecma_string (str_p);
        -:  354:  }
        -:  355:
    #####:  356:  return ecma_stringbuilder_finalize (&builder);
        -:  357:} /* ecma_op_create_dynamic_function_arguments_helper */
        -:  358:
        -:  359:/**
        -:  360: * Function object creation operation.
        -:  361: *
        -:  362: * See also: ECMA-262 v5, 13.2
        -:  363: *
        -:  364: * @return pointer to newly created Function object
        -:  365: */
        -:  366:static ecma_object_t *
       19:  367:ecma_op_create_function_object (ecma_object_t *scope_p, /**< function's scope */
        -:  368:                                const ecma_compiled_code_t *bytecode_data_p, /**< byte-code array */
        -:  369:                                ecma_builtin_id_t proto_id) /**< builtin id of the prototype object */
        -:  370:{
       19:  371:  JERRY_ASSERT (ecma_is_lexical_environment (scope_p));
        -:  372:
        -:  373:  /* 1., 4., 13. */
       19:  374:  ecma_object_t *prototype_obj_p = ecma_builtin_get (proto_id);
        -:  375:
       19:  376:  size_t function_object_size = sizeof (ecma_extended_object_t);
        -:  377:
        -:  378:#if JERRY_SNAPSHOT_EXEC
    #####:  379:  if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_STATIC_FUNCTION)
        -:  380:  {
    #####:  381:    function_object_size = sizeof (ecma_static_function_t);
        -:  382:  }
        -:  383:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  384:
       19:  385:  ecma_object_t *func_p = ecma_create_object (prototype_obj_p, function_object_size, ECMA_OBJECT_TYPE_FUNCTION);
        -:  386:
        -:  387:  /* 2., 6., 7., 8. */
        -:  388:  /*
        -:  389:   * We don't setup [[Get]], [[Call]], [[Construct]], [[HasInstance]] for each function object.
        -:  390:   * Instead we set the object's type to ECMA_OBJECT_TYPE_FUNCTION
        -:  391:   * that defines which version of the routine should be used on demand.
        -:  392:   */
        -:  393:
        -:  394:  /* 3. */
        -:  395:  /*
        -:  396:   * [[Class]] property is not stored explicitly for objects of ECMA_OBJECT_TYPE_FUNCTION type.
        -:  397:   *
        -:  398:   * See also: ecma_object_get_class_name
        -:  399:   */
        -:  400:
       19:  401:  ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) func_p;
        -:  402:
        -:  403:  /* 9. */
       19:  404:  ECMA_SET_NON_NULL_POINTER_TAG (ext_func_p->u.function.scope_cp, scope_p, 0);
        -:  405:
        -:  406:  /* 10., 11., 12. */
        -:  407:
        -:  408:#if JERRY_SNAPSHOT_EXEC
    #####:  409:  if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_STATIC_FUNCTION)
        -:  410:  {
    #####:  411:    ext_func_p->u.function.bytecode_cp = JMEM_CP_NULL;
    #####:  412:    ((ecma_static_function_t *) func_p)->bytecode_p = bytecode_data_p;
        -:  413:  }
        -:  414:  else
        -:  415:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  416:  {
       19:  417:    ECMA_SET_INTERNAL_VALUE_POINTER (ext_func_p->u.function.bytecode_cp, bytecode_data_p);
       19:  418:    ecma_bytecode_ref ((ecma_compiled_code_t *) bytecode_data_p);
        -:  419:  }
        -:  420:
        -:  421:  /* 14., 15., 16., 17., 18. */
        -:  422:  /*
        -:  423:   * 'length' and 'prototype' properties are instantiated lazily
        -:  424:   *
        -:  425:   * See also: ecma_op_function_try_to_lazy_instantiate_property
        -:  426:   */
        -:  427:
       19:  428:  return func_p;
        -:  429:} /* ecma_op_create_function_object */
        -:  430:
        -:  431:/**
        -:  432: * CreateDynamicFunction operation
        -:  433: *
        -:  434: * See also:
        -:  435: *          ECMA-262 v5, 15.3.
        -:  436: *          ECMA-262 v6, 19.2.1.1
        -:  437: *
        -:  438: * @return ECMA_VALUE_ERROR - if the operation fails
        -:  439: *         constructed function object - otherwise
        -:  440: */
        -:  441:ecma_value_t
    #####:  442:ecma_op_create_dynamic_function (const ecma_value_t *arguments_list_p, /**< arguments list */
        -:  443:                                 uint32_t arguments_list_len, /**< number of arguments */
        -:  444:                                 ecma_parse_opts_t parse_opts) /**< parse options */
        -:  445:{
    #####:  446:  JERRY_ASSERT (arguments_list_len == 0 || arguments_list_p != NULL);
        -:  447:
    #####:  448:  ecma_string_t *arguments_str_p =
        -:  449:    ecma_op_create_dynamic_function_arguments_helper (arguments_list_p, arguments_list_len);
        -:  450:
    #####:  451:  if (JERRY_UNLIKELY (arguments_str_p == NULL))
        -:  452:  {
    #####:  453:    return ECMA_VALUE_ERROR;
        -:  454:  }
        -:  455:
        -:  456:  ecma_string_t *function_body_str_p;
        -:  457:
    #####:  458:  if (arguments_list_len > 0)
        -:  459:  {
    #####:  460:    function_body_str_p = ecma_op_to_string (arguments_list_p[arguments_list_len - 1]);
        -:  461:
    #####:  462:    if (JERRY_UNLIKELY (function_body_str_p == NULL))
        -:  463:    {
    #####:  464:      ecma_deref_ecma_string (arguments_str_p);
    #####:  465:      return ECMA_VALUE_ERROR;
        -:  466:    }
        -:  467:  }
        -:  468:  else
        -:  469:  {
        -:  470:    /* Very unlikely code path, not optimized. */
    #####:  471:    function_body_str_p = ecma_get_magic_string (LIT_MAGIC_STRING__EMPTY);
        -:  472:  }
        -:  473:
    #####:  474:  ecma_value_t source[2];
    #####:  475:  source[0] = ecma_make_string_value (function_body_str_p);
    #####:  476:  source[1] = ecma_make_string_value (arguments_str_p);
        -:  477:
    #####:  478:  parse_opts |= ECMA_PARSE_HAS_SOURCE_VALUE | ECMA_PARSE_HAS_ARGUMENT_LIST_VALUE;
        -:  479:
    #####:  480:  ecma_compiled_code_t *bytecode_p = parser_parse_script ((void *) source, parse_opts, NULL);
        -:  481:
    #####:  482:  ecma_deref_ecma_string (arguments_str_p);
    #####:  483:  ecma_deref_ecma_string (function_body_str_p);
        -:  484:
    #####:  485:  if (JERRY_UNLIKELY (bytecode_p == NULL))
        -:  486:  {
    #####:  487:    return ECMA_VALUE_ERROR;
        -:  488:  }
        -:  489:
        -:  490:#if JERRY_ESNEXT
        -:  491:  ecma_value_t *func_name_p;
    #####:  492:  func_name_p = ecma_compiled_code_resolve_function_name ((const ecma_compiled_code_t *) bytecode_p);
    #####:  493:  *func_name_p = ecma_make_magic_string_value (LIT_MAGIC_STRING_ANONYMOUS);
        -:  494:#endif /* JERRY_ESNEXT */
        -:  495:
    #####:  496:  ecma_object_t *global_object_p = ecma_builtin_get_global ();
        -:  497:
        -:  498:#if JERRY_BUILTIN_REALMS
    #####:  499:  JERRY_ASSERT (global_object_p == (ecma_object_t *) ecma_op_function_get_realm (bytecode_p));
        -:  500:#endif /* JERRY_BUILTIN_REALMS */
        -:  501:
    #####:  502:  ecma_object_t *global_env_p = ecma_get_global_environment (global_object_p);
    #####:  503:  ecma_builtin_id_t fallback_proto = ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE;
        -:  504:
        -:  505:#if JERRY_ESNEXT
    #####:  506:  ecma_object_t *new_target_p = JERRY_CONTEXT (current_new_target_p);
    #####:  507:  ecma_builtin_id_t fallback_ctor = ECMA_BUILTIN_ID_FUNCTION;
        -:  508:
    #####:  509:  if (JERRY_UNLIKELY (parse_opts & (ECMA_PARSE_GENERATOR_FUNCTION | ECMA_PARSE_ASYNC_FUNCTION)))
        -:  510:  {
    #####:  511:    fallback_proto = ECMA_BUILTIN_ID_ASYNC_GENERATOR;
    #####:  512:    fallback_ctor = ECMA_BUILTIN_ID_ASYNC_GENERATOR_FUNCTION;
        -:  513:
    #####:  514:    if (!(parse_opts & ECMA_PARSE_GENERATOR_FUNCTION))
        -:  515:    {
    #####:  516:      fallback_proto = ECMA_BUILTIN_ID_ASYNC_FUNCTION_PROTOTYPE;
    #####:  517:      fallback_ctor = ECMA_BUILTIN_ID_ASYNC_FUNCTION;
        -:  518:    }
    #####:  519:    else if (!(parse_opts & ECMA_PARSE_ASYNC_FUNCTION))
        -:  520:    {
    #####:  521:      fallback_proto = ECMA_BUILTIN_ID_GENERATOR;
    #####:  522:      fallback_ctor = ECMA_BUILTIN_ID_GENERATOR_FUNCTION;
        -:  523:    }
        -:  524:  }
        -:  525:
    #####:  526:  if (new_target_p == NULL)
        -:  527:  {
    #####:  528:    new_target_p = ecma_builtin_get (fallback_ctor);
        -:  529:  }
        -:  530:
    #####:  531:  ecma_object_t *proto = ecma_op_get_prototype_from_constructor (new_target_p, fallback_proto);
        -:  532:
    #####:  533:  if (JERRY_UNLIKELY (proto == NULL))
        -:  534:  {
    #####:  535:    ecma_bytecode_deref (bytecode_p);
    #####:  536:    return ECMA_VALUE_ERROR;
        -:  537:  }
        -:  538:#endif /* JERRY_ESNEXT */
        -:  539:
    #####:  540:  ecma_object_t *func_obj_p = ecma_op_create_function_object (global_env_p, bytecode_p, fallback_proto);
        -:  541:
        -:  542:#if JERRY_ESNEXT
    #####:  543:  ECMA_SET_NON_NULL_POINTER (func_obj_p->u2.prototype_cp, proto);
    #####:  544:  ecma_deref_object (proto);
        -:  545:#endif /* JERRY_ESNEXT */
        -:  546:
    #####:  547:  ecma_bytecode_deref (bytecode_p);
    #####:  548:  return ecma_make_object_value (func_obj_p);
        -:  549:} /* ecma_op_create_dynamic_function */
        -:  550:
        -:  551:/**
        -:  552: * Function object creation operation.
        -:  553: *
        -:  554: * See also: ECMA-262 v5, 13.2
        -:  555: *
        -:  556: * @return pointer to newly created Function object
        -:  557: */
        -:  558:ecma_object_t *
    #####:  559:ecma_op_create_simple_function_object (ecma_object_t *scope_p, /**< function's scope */
        -:  560:                                       const ecma_compiled_code_t *bytecode_data_p) /**< byte-code array */
        -:  561:{
    #####:  562:  return ecma_op_create_function_object (scope_p, bytecode_data_p, ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE);
        -:  563:} /* ecma_op_create_simple_function_object */
        -:  564:
        -:  565:#if JERRY_ESNEXT
        -:  566:
        -:  567:/**
        -:  568: * Create a function object with the appropriate prototype.
        -:  569: *
        -:  570: * @return pointer to newly created Function object
        -:  571: */
        -:  572:ecma_object_t *
       19:  573:ecma_op_create_any_function_object (ecma_object_t *scope_p, /**< function's scope */
        -:  574:                                    const ecma_compiled_code_t *bytecode_data_p) /**< byte-code array */
        -:  575:{
        -:  576:  ecma_builtin_id_t proto_id;
        -:  577:
       19:  578:  switch (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags))
        -:  579:  {
    #####:  580:    case CBC_FUNCTION_GENERATOR:
        -:  581:    {
    #####:  582:      proto_id = ECMA_BUILTIN_ID_GENERATOR;
    #####:  583:      break;
        -:  584:    }
    #####:  585:    case CBC_FUNCTION_ASYNC:
        -:  586:    {
    #####:  587:      proto_id = ECMA_BUILTIN_ID_ASYNC_FUNCTION_PROTOTYPE;
    #####:  588:      break;
        -:  589:    }
    #####:  590:    case CBC_FUNCTION_ASYNC_GENERATOR:
        -:  591:    {
    #####:  592:      proto_id = ECMA_BUILTIN_ID_ASYNC_GENERATOR;
    #####:  593:      break;
        -:  594:    }
       19:  595:    default:
        -:  596:    {
       19:  597:      proto_id = ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE;
       19:  598:      break;
        -:  599:    }
        -:  600:  }
        -:  601:
       19:  602:  return ecma_op_create_function_object (scope_p, bytecode_data_p, proto_id);
        -:  603:} /* ecma_op_create_any_function_object */
        -:  604:
        -:  605:/**
        -:  606: * Arrow function object creation operation.
        -:  607: *
        -:  608: * See also: ES2015, 9.2.12
        -:  609: *
        -:  610: * @return pointer to newly created Function object
        -:  611: */
        -:  612:ecma_object_t *
        1:  613:ecma_op_create_arrow_function_object (ecma_object_t *scope_p, /**< function's scope */
        -:  614:                                      const ecma_compiled_code_t *bytecode_data_p, /**< byte-code array */
        -:  615:                                      ecma_value_t this_binding) /**< value of 'this' binding */
        -:  616:{
        -:  617:  ecma_object_t *prototype_obj_p;
        -:  618:
        1:  619:  if (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) == CBC_FUNCTION_ARROW)
        -:  620:  {
        1:  621:    prototype_obj_p = ecma_builtin_get (ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE);
        -:  622:  }
        -:  623:  else
        -:  624:  {
    #####:  625:    JERRY_ASSERT (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) == CBC_FUNCTION_ASYNC_ARROW);
    #####:  626:    prototype_obj_p = ecma_builtin_get (ECMA_BUILTIN_ID_ASYNC_FUNCTION_PROTOTYPE);
        -:  627:  }
        -:  628:
        1:  629:  size_t arrow_function_object_size = sizeof (ecma_arrow_function_t);
        -:  630:
        -:  631:#if JERRY_SNAPSHOT_EXEC
    #####:  632:  if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_STATIC_FUNCTION)
        -:  633:  {
    #####:  634:    arrow_function_object_size = sizeof (ecma_static_arrow_function_t);
        -:  635:  }
        -:  636:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  637:
        1:  638:  ecma_object_t *func_p = ecma_create_object (prototype_obj_p, arrow_function_object_size, ECMA_OBJECT_TYPE_FUNCTION);
        -:  639:
        1:  640:  ecma_arrow_function_t *arrow_func_p = (ecma_arrow_function_t *) func_p;
        -:  641:
        1:  642:  ECMA_SET_NON_NULL_POINTER_TAG (arrow_func_p->header.u.function.scope_cp, scope_p, 0);
        -:  643:
        -:  644:#if JERRY_SNAPSHOT_EXEC
    #####:  645:  if ((bytecode_data_p->status_flags & CBC_CODE_FLAGS_STATIC_FUNCTION))
        -:  646:  {
    #####:  647:    arrow_func_p->header.u.function.bytecode_cp = ECMA_NULL_POINTER;
    #####:  648:    ((ecma_static_arrow_function_t *) func_p)->bytecode_p = bytecode_data_p;
        -:  649:  }
        -:  650:  else
        -:  651:  {
        -:  652:#endif /* JERRY_SNAPSHOT_EXEC */
        1:  653:    ECMA_SET_INTERNAL_VALUE_POINTER (arrow_func_p->header.u.function.bytecode_cp, bytecode_data_p);
        1:  654:    ecma_bytecode_ref ((ecma_compiled_code_t *) bytecode_data_p);
        -:  655:#if JERRY_SNAPSHOT_EXEC
        -:  656:  }
        -:  657:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  658:
        1:  659:  arrow_func_p->this_binding = ecma_copy_value_if_not_object (this_binding);
        1:  660:  arrow_func_p->new_target = ECMA_VALUE_UNDEFINED;
        -:  661:
        1:  662:  if (JERRY_CONTEXT (current_new_target_p) != NULL)
        -:  663:  {
        1:  664:    arrow_func_p->new_target = ecma_make_object_value (JERRY_CONTEXT (current_new_target_p));
        -:  665:  }
        1:  666:  return func_p;
        -:  667:} /* ecma_op_create_arrow_function_object */
        -:  668:
        -:  669:#endif /* JERRY_ESNEXT */
        -:  670:
        -:  671:/**
        -:  672: * External function object creation operation.
        -:  673: *
        -:  674: * Note:
        -:  675: *      external function object is implementation-defined object type
        -:  676: *      that represent functions implemented in native code, using Embedding API
        -:  677: *
        -:  678: * @return pointer to newly created external function object
        -:  679: */
        -:  680:ecma_object_t *
        5:  681:ecma_op_create_external_function_object (ecma_native_handler_t handler_cb) /**< pointer to external native handler */
        -:  682:{
        5:  683:  ecma_object_t *prototype_obj_p = ecma_builtin_get (ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE);
        -:  684:
        5:  685:  ecma_object_t *function_obj_p =
        -:  686:    ecma_create_object (prototype_obj_p, sizeof (ecma_native_function_t), ECMA_OBJECT_TYPE_NATIVE_FUNCTION);
        -:  687:
        -:  688:  /*
        -:  689:   * [[Class]] property is not stored explicitly for objects of ECMA_OBJECT_TYPE_NATIVE_FUNCTION type.
        -:  690:   *
        -:  691:   * See also: ecma_object_get_class_name
        -:  692:   */
        -:  693:
        5:  694:  ecma_native_function_t *native_function_p = (ecma_native_function_t *) function_obj_p;
        -:  695:#if JERRY_BUILTIN_REALMS
        5:  696:  ECMA_SET_INTERNAL_VALUE_POINTER (native_function_p->realm_value, ecma_builtin_get_global ());
        -:  697:#endif /* JERRY_BUILTIN_REALMS */
        5:  698:  native_function_p->native_handler_cb = handler_cb;
        -:  699:
        5:  700:  return function_obj_p;
        -:  701:} /* ecma_op_create_external_function_object */
        -:  702:
        -:  703:#if JERRY_ESNEXT
        -:  704:
        -:  705:/**
        -:  706: * Create built-in native handler object.
        -:  707: *
        -:  708: * @return pointer to newly created native handler object
        -:  709: */
        -:  710:ecma_object_t *
    #####:  711:ecma_op_create_native_handler (ecma_native_handler_id_t id, /**< handler id */
        -:  712:                               size_t object_size) /**< created object size */
        -:  713:{
    #####:  714:  ecma_object_t *prototype_obj_p = ecma_builtin_get (ECMA_BUILTIN_ID_FUNCTION_PROTOTYPE);
        -:  715:
    #####:  716:  ecma_object_t *function_obj_p = ecma_create_object (prototype_obj_p, object_size, ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION);
        -:  717:
    #####:  718:  ecma_extended_object_t *ext_func_obj_p = (ecma_extended_object_t *) function_obj_p;
    #####:  719:  ext_func_obj_p->u.built_in.id = ECMA_BUILTIN_ID_HANDLER;
    #####:  720:  ext_func_obj_p->u.built_in.routine_id = (uint8_t) id;
    #####:  721:  ext_func_obj_p->u.built_in.u2.routine_flags = ECMA_NATIVE_HANDLER_FLAGS_NONE;
        -:  722:
        -:  723:#if JERRY_BUILTIN_REALMS
    #####:  724:  ECMA_SET_INTERNAL_VALUE_POINTER (ext_func_obj_p->u.built_in.realm_value, ecma_builtin_get_global ());
        -:  725:#endif /* JERRY_BUILTIN_REALMS */
        -:  726:
    #####:  727:  return function_obj_p;
        -:  728:} /* ecma_op_create_native_handler */
        -:  729:
        -:  730:#endif /* JERRY_ESNEXT */
        -:  731:
        -:  732:/**
        -:  733: * Get compiled code of a function object.
        -:  734: *
        -:  735: * @return compiled code
        -:  736: */
        -:  737:extern inline const ecma_compiled_code_t *JERRY_ATTR_ALWAYS_INLINE
    #####:  738:ecma_op_function_get_compiled_code (ecma_extended_object_t *function_p) /**< function pointer */
        -:  739:{
        -:  740:#if JERRY_SNAPSHOT_EXEC
    #####:  741:  if (JERRY_LIKELY (function_p->u.function.bytecode_cp != ECMA_NULL_POINTER))
        -:  742:  {
    #####:  743:    return ECMA_GET_INTERNAL_VALUE_POINTER (const ecma_compiled_code_t, function_p->u.function.bytecode_cp);
        -:  744:  }
        -:  745:
    #####:  746:  return ((ecma_static_function_t *) function_p)->bytecode_p;
        -:  747:#else /* !JERRY_SNAPSHOT_EXEC */
       26:  748:  return ECMA_GET_INTERNAL_VALUE_POINTER (const ecma_compiled_code_t, function_p->u.function.bytecode_cp);
        -:  749:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  750:} /* ecma_op_function_get_compiled_code */
        -:  751:
        -:  752:#if JERRY_BUILTIN_REALMS
        -:  753:
        -:  754:/**
        -:  755: * Get realm from a byte code.
        -:  756: *
        -:  757: * Note:
        -:  758: *   Does not increase the reference counter.
        -:  759: *
        -:  760: * @return pointer to realm (global) object
        -:  761: */
        -:  762:extern inline ecma_global_object_t *JERRY_ATTR_ALWAYS_INLINE
        1:  763:ecma_op_function_get_realm (const ecma_compiled_code_t *bytecode_header_p) /**< byte code header */
        -:  764:{
        -:  765:#if JERRY_SNAPSHOT_EXEC
    #####:  766:  if (JERRY_UNLIKELY (bytecode_header_p->status_flags & CBC_CODE_FLAGS_STATIC_FUNCTION))
        -:  767:  {
    #####:  768:    return (ecma_global_object_t *) ecma_builtin_get_global ();
        -:  769:  }
        -:  770:#endif /* JERRY_SNAPSHOT_EXEC */
        -:  771:
       27:  772:  ecma_value_t script_value = ((cbc_uint8_arguments_t *) bytecode_header_p)->script_value;
       27:  773:  cbc_script_t *script_p = ECMA_GET_INTERNAL_VALUE_POINTER (cbc_script_t, script_value);
        -:  774:
       27:  775:  return (ecma_global_object_t *) script_p->realm_p;
        -:  776:} /* ecma_op_function_get_realm */
        -:  777:
        -:  778:/**
        -:  779: * Get realm from a function
        -:  780: *
        -:  781: * Note:
        -:  782: *   Does not increase the reference counter.
        -:  783: *
        -:  784: * @return realm (global) object
        -:  785: */
        -:  786:ecma_global_object_t *
    #####:  787:ecma_op_function_get_function_realm (ecma_object_t *func_obj_p) /**< function object */
        -:  788:{
        -:  789:  while (true)
    #####:  790:  {
    #####:  791:    ecma_object_type_t type = ecma_get_object_type (func_obj_p);
        -:  792:
    #####:  793:    if (type == ECMA_OBJECT_TYPE_FUNCTION)
        -:  794:    {
    #####:  795:      ecma_extended_object_t *ext_function_obj_p = (ecma_extended_object_t *) func_obj_p;
    #####:  796:      const ecma_compiled_code_t *bytecode_data_p = ecma_op_function_get_compiled_code (ext_function_obj_p);
    #####:  797:      return ecma_op_function_get_realm (bytecode_data_p);
        -:  798:    }
        -:  799:
    #####:  800:    if (type == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION)
        -:  801:    {
    #####:  802:      ecma_extended_object_t *ext_function_obj_p = (ecma_extended_object_t *) func_obj_p;
    #####:  803:      return ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, ext_function_obj_p->u.built_in.realm_value);
        -:  804:    }
        -:  805:
    #####:  806:    if (type == ECMA_OBJECT_TYPE_NATIVE_FUNCTION)
        -:  807:    {
    #####:  808:      ecma_native_function_t *native_function_p = (ecma_native_function_t *) func_obj_p;
    #####:  809:      return ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, native_function_p->realm_value);
        -:  810:    }
        -:  811:
        -:  812:#if JERRY_ESNEXT
    #####:  813:    if (type == ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION)
        -:  814:    {
    #####:  815:      ecma_value_t script_value = ((ecma_extended_object_t *) func_obj_p)->u.constructor_function.script_value;
    #####:  816:      cbc_script_t *script_p = ECMA_GET_INTERNAL_VALUE_POINTER (cbc_script_t, script_value);
        -:  817:
    #####:  818:      return (ecma_global_object_t *) script_p->realm_p;
        -:  819:    }
        -:  820:#endif /* JERRY_ESNEXT */
        -:  821:
        -:  822:#if JERRY_BUILTIN_PROXY
    #####:  823:    if (ECMA_OBJECT_IS_PROXY (func_obj_p))
        -:  824:    {
    #####:  825:      ecma_proxy_object_t *proxy_obj_p = (ecma_proxy_object_t *) func_obj_p;
    #####:  826:      if (ecma_is_value_null (proxy_obj_p->handler))
        -:  827:      {
    #####:  828:        ecma_raise_type_error (ECMA_ERR_PROTOTYPE_FROM_REVOKED_PROXY_IS_INVALID);
    #####:  829:        return NULL;
        -:  830:      }
    #####:  831:      func_obj_p = ecma_get_object_from_value (proxy_obj_p->target);
    #####:  832:      continue;
        -:  833:    }
        -:  834:#endif /* JERRY_BUILTIN_PROXY */
        -:  835:
    #####:  836:    JERRY_ASSERT (type == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
    #####:  837:    ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) func_obj_p;
    #####:  838:    func_obj_p =
    #####:  839:      ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, bound_func_p->header.u.bound_function.target_function);
        -:  840:  }
        -:  841:} /* ecma_op_function_get_function_realm */
        -:  842:
        -:  843:#endif /* JERRY_BUILTIN_REALMS */
        -:  844:
        -:  845:/**
        -:  846: * 15.3.5.3 implementation of [[HasInstance]] for Function objects
        -:  847: *
        -:  848: * @return true/false - if arguments are valid
        -:  849: *         error - otherwise
        -:  850: *         Returned value must be freed with ecma_free_value
        -:  851: */
        -:  852:ecma_value_t
    #####:  853:ecma_op_function_has_instance (ecma_object_t *func_obj_p, /**< Function object */
        -:  854:                               ecma_value_t value) /**< argument 'V' */
        -:  855:{
    #####:  856:  JERRY_ASSERT (func_obj_p != NULL && !ecma_is_lexical_environment (func_obj_p));
        -:  857:
    #####:  858:  if (!ecma_is_value_object (value))
        -:  859:  {
    #####:  860:    return ECMA_VALUE_FALSE;
        -:  861:  }
        -:  862:
    #####:  863:  while (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION)
        -:  864:  {
    #####:  865:    JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
        -:  866:
        -:  867:    /* 1. 3. */
    #####:  868:    ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) func_obj_p;
        -:  869:
    #####:  870:    func_obj_p =
    #####:  871:      ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, bound_func_p->header.u.bound_function.target_function);
        -:  872:  }
        -:  873:
    #####:  874:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_FUNCTION
        -:  875:                || ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION
        -:  876:                || ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION
        -:  877:                || ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_NATIVE_FUNCTION
        -:  878:                || ECMA_OBJECT_IS_PROXY (func_obj_p));
        -:  879:
    #####:  880:  ecma_object_t *v_obj_p = ecma_get_object_from_value (value);
        -:  881:
    #####:  882:  ecma_value_t prototype_obj_value = ecma_op_object_get_by_magic_id (func_obj_p, LIT_MAGIC_STRING_PROTOTYPE);
        -:  883:
    #####:  884:  if (ECMA_IS_VALUE_ERROR (prototype_obj_value))
        -:  885:  {
    #####:  886:    return prototype_obj_value;
        -:  887:  }
        -:  888:
    #####:  889:  if (!ecma_is_value_object (prototype_obj_value))
        -:  890:  {
    #####:  891:    ecma_free_value (prototype_obj_value);
    #####:  892:    return ecma_raise_type_error (ECMA_ERR_OBJECT_EXPECTED);
        -:  893:  }
        -:  894:
    #####:  895:  ecma_object_t *prototype_obj_p = ecma_get_object_from_value (prototype_obj_value);
    #####:  896:  JERRY_ASSERT (prototype_obj_p != NULL);
        -:  897:
        -:  898:#if JERRY_BUILTIN_PROXY
    #####:  899:  ecma_value_t result = ECMA_VALUE_ERROR;
        -:  900:#else /* !JERRY_BUILTIN_PROXY */
    #####:  901:  ecma_value_t result = ECMA_VALUE_FALSE;
        -:  902:#endif /* JERRY_BUILTIN_PROXY */
        -:  903:
    #####:  904:  ecma_ref_object (v_obj_p);
        -:  905:
        -:  906:  while (true)
    #####:  907:  {
    #####:  908:    ecma_object_t *current_proto_p = ecma_op_object_get_prototype_of (v_obj_p);
    #####:  909:    ecma_deref_object (v_obj_p);
        -:  910:
    #####:  911:    if (current_proto_p == NULL)
        -:  912:    {
        -:  913:#if JERRY_BUILTIN_PROXY
    #####:  914:      result = ECMA_VALUE_FALSE;
        -:  915:#endif /* JERRY_BUILTIN_PROXY */
    #####:  916:      break;
        -:  917:    }
    #####:  918:    else if (current_proto_p == ECMA_OBJECT_POINTER_ERROR)
        -:  919:    {
    #####:  920:      break;
        -:  921:    }
        -:  922:
    #####:  923:    if (current_proto_p == prototype_obj_p)
        -:  924:    {
    #####:  925:      ecma_deref_object (current_proto_p);
    #####:  926:      result = ECMA_VALUE_TRUE;
    #####:  927:      break;
        -:  928:    }
        -:  929:
        -:  930:    /* Advance up on prototype chain. */
    #####:  931:    v_obj_p = current_proto_p;
        -:  932:  }
        -:  933:
    #####:  934:  ecma_deref_object (prototype_obj_p);
    #####:  935:  return result;
        -:  936:} /* ecma_op_function_has_instance */
        -:  937:
        -:  938:#if JERRY_ESNEXT
        -:  939:
        -:  940:/**
        -:  941: * GetSuperConstructor operation for class methods
        -:  942: *
        -:  943: * See also: ECMAScript v6, 12.3.5.2
        -:  944: *
        -:  945: * @return ECMA_VALUE_ERROR - if the operation fails
        -:  946: *         super constructor - otherwise
        -:  947: */
        -:  948:ecma_value_t
    #####:  949:ecma_op_function_get_super_constructor (ecma_object_t *func_obj_p) /**< function object */
        -:  950:{
    #####:  951:  ecma_object_t *super_ctor_p = ecma_op_object_get_prototype_of (func_obj_p);
        -:  952:
    #####:  953:  if (JERRY_UNLIKELY (super_ctor_p == ECMA_OBJECT_POINTER_ERROR))
        -:  954:  {
    #####:  955:    return ECMA_VALUE_ERROR;
        -:  956:  }
    #####:  957:  else if (super_ctor_p == NULL || !ecma_object_is_constructor (super_ctor_p))
        -:  958:  {
    #####:  959:    if (super_ctor_p != NULL)
        -:  960:    {
    #####:  961:      ecma_deref_object (super_ctor_p);
        -:  962:    }
    #####:  963:    return ecma_raise_type_error (ECMA_ERR_SUPER_BINDING_MUST_BE_A_CONSTRUCTOR);
        -:  964:  }
        -:  965:
    #####:  966:  return ecma_make_object_value (super_ctor_p);
        -:  967:} /* ecma_op_function_get_super_constructor */
        -:  968:#endif /* JERRY_ESNEXT */
        -:  969:
        -:  970:/**
        -:  971: * Ordinary internal method: GetPrototypeFromConstructor (constructor, intrinsicDefaultProto)
        -:  972: *
        -:  973: * See also:
        -:  974: *   - ECMAScript v6, 9.1.15
        -:  975: *   - ECMAScript v10, 9.1.14
        -:  976: *
        -:  977: * @return NULL - if the operation fail (exception on the global context is raised)
        -:  978: *         pointer to the prototype object - otherwise
        -:  979: */
        -:  980:ecma_object_t *
    #####:  981:ecma_op_get_prototype_from_constructor (ecma_object_t *ctor_obj_p, /**< constructor to get prototype from  */
        -:  982:                                        ecma_builtin_id_t default_proto_id) /**< intrinsicDefaultProto */
        -:  983:{
    #####:  984:  JERRY_ASSERT (ecma_op_object_is_callable (ctor_obj_p));
    #####:  985:  JERRY_ASSERT (default_proto_id < ECMA_BUILTIN_ID__COUNT);
        -:  986:
    #####:  987:  ecma_value_t proto = ecma_op_object_get_by_magic_id (ctor_obj_p, LIT_MAGIC_STRING_PROTOTYPE);
        -:  988:
    #####:  989:  if (ECMA_IS_VALUE_ERROR (proto))
        -:  990:  {
    #####:  991:    return NULL;
        -:  992:  }
        -:  993:
        -:  994:  ecma_object_t *proto_obj_p;
        -:  995:
    #####:  996:  if (!ecma_is_value_object (proto))
        -:  997:  {
    #####:  998:    ecma_free_value (proto);
        -:  999:
        -: 1000:#if JERRY_BUILTIN_PROXY
    #####: 1001:    if (ECMA_OBJECT_IS_PROXY (ctor_obj_p))
        -: 1002:    {
    #####: 1003:      ecma_proxy_object_t *proxy_obj_p = (ecma_proxy_object_t *) ctor_obj_p;
    #####: 1004:      if (ecma_is_value_null (proxy_obj_p->handler))
        -: 1005:      {
    #####: 1006:        ecma_raise_type_error (ECMA_ERR_PROTOTYPE_FROM_REVOKED_PROXY_IS_INVALID);
    #####: 1007:        return NULL;
        -: 1008:      }
        -: 1009:    }
        -: 1010:#endif /* JERRY_BUILTIN_PROXY */
        -: 1011:
        -: 1012:#if JERRY_BUILTIN_REALMS
    #####: 1013:    proto_obj_p = ecma_builtin_get_from_realm (ecma_op_function_get_function_realm (ctor_obj_p), default_proto_id);
        -: 1014:#else /* !JERRY_BUILTIN_REALMS */
    #####: 1015:    proto_obj_p = ecma_builtin_get (default_proto_id);
        -: 1016:#endif /* JERRY_BUILTIN_REALMS */
    #####: 1017:    ecma_ref_object (proto_obj_p);
        -: 1018:  }
        -: 1019:  else
        -: 1020:  {
    #####: 1021:    proto_obj_p = ecma_get_object_from_value (proto);
        -: 1022:  }
        -: 1023:
    #####: 1024:  return proto_obj_p;
        -: 1025:} /* ecma_op_get_prototype_from_constructor */
        -: 1026:
        -: 1027:#if JERRY_ESNEXT
        -: 1028:/**
        -: 1029: * Perform a JavaScript class function object method call.
        -: 1030: *
        -: 1031: * The input function object should be a JavaScript class constructor
        -: 1032: *
        -: 1033: * @return the result of the function call.
        -: 1034: */
        -: 1035:static ecma_value_t JERRY_ATTR_NOINLINE
        5: 1036:ecma_op_function_call_constructor (vm_frame_ctx_shared_args_t *shared_args_p, /**< shared data */
        -: 1037:                                   ecma_object_t *scope_p, /**< lexical environment to use */
        -: 1038:                                   ecma_value_t this_binding) /**< value of 'ThisBinding' */
        -: 1039:{
        5: 1040:  shared_args_p->header.status_flags |= VM_FRAME_CTX_SHARED_NON_ARROW_FUNC;
        -: 1041:
        -: 1042:  ecma_value_t ret_value;
        -: 1043:
        5: 1044:  if (JERRY_CONTEXT (current_new_target_p) == NULL)
        -: 1045:  {
    #####: 1046:    ret_value = ecma_raise_type_error (ECMA_ERR_CLASS_CONSTRUCTOR_REQUIRES_NEW);
    #####: 1047:    goto exit;
        -: 1048:  }
        -: 1049:
        5: 1050:  ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) shared_args_p->header.function_object_p;
        5: 1051:  if (ECMA_GET_THIRD_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp))
        -: 1052:  {
        5: 1053:    this_binding = ECMA_VALUE_UNINITIALIZED;
        -: 1054:  }
        -: 1055:
        5: 1056:  ecma_op_create_environment_record (scope_p, this_binding, shared_args_p->header.function_object_p);
        -: 1057:
        -: 1058:#if JERRY_BUILTIN_REALMS
        5: 1059:  ecma_global_object_t *saved_global_object_p = JERRY_CONTEXT (global_object_p);
       10: 1060:  JERRY_CONTEXT (global_object_p) = ecma_op_function_get_realm (shared_args_p->header.bytecode_header_p);
        -: 1061:#endif /* JERRY_BUILTIN_REALMS */
        -: 1062:
        5: 1063:  ret_value = vm_run (&shared_args_p->header, this_binding, scope_p);
        -: 1064:
        -: 1065:#if JERRY_BUILTIN_REALMS
        4: 1066:  JERRY_CONTEXT (global_object_p) = saved_global_object_p;
        -: 1067:#endif /* JERRY_BUILTIN_REALMS */
        -: 1068:
        -: 1069:  /* ECMAScript v6, 9.2.2.13 */
        4: 1070:  if (JERRY_UNLIKELY (this_binding == ECMA_VALUE_UNINITIALIZED))
        -: 1071:  {
        4: 1072:    if (!ECMA_IS_VALUE_ERROR (ret_value) && !ecma_is_value_object (ret_value))
        -: 1073:    {
    #####: 1074:      if (!ecma_is_value_undefined (ret_value))
        -: 1075:      {
    #####: 1076:        ecma_free_value (ret_value);
    #####: 1077:        ret_value = ecma_raise_type_error (ECMA_ERR_DERIVED_CTOR_RETURN_NOR_OBJECT_OR_UNDEFINED);
        -: 1078:      }
        -: 1079:      else
        -: 1080:      {
    #####: 1081:        ret_value = ecma_op_get_this_binding (scope_p);
        -: 1082:      }
        -: 1083:    }
        -: 1084:  }
        -: 1085:
        8: 1086:exit:
        4: 1087:  if (JERRY_UNLIKELY (shared_args_p->header.status_flags & VM_FRAME_CTX_SHARED_FREE_LOCAL_ENV))
        -: 1088:  {
        4: 1089:    ecma_deref_object (scope_p);
        -: 1090:  }
        -: 1091:
        4: 1092:  return ret_value;
        -: 1093:} /* ecma_op_function_call_constructor */
        -: 1094:
        -: 1095:#endif /* JERRY_ESNEXT */
        -: 1096:
        -: 1097:/**
        -: 1098: * Perform a JavaScript function object method call.
        -: 1099: *
        -: 1100: * The input function object should be a pure JavaScript method
        -: 1101: *
        -: 1102: * @return the result of the function call.
        -: 1103: */
        -: 1104:static ecma_value_t
       21: 1105:ecma_op_function_call_simple (ecma_object_t *func_obj_p, /**< Function object */
        -: 1106:                              ecma_value_t this_binding, /**< 'this' argument's value */
        -: 1107:                              const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1108:                              uint32_t arguments_list_len) /**< length of arguments list */
        -: 1109:{
       21: 1110:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_FUNCTION);
        -: 1111:
       21: 1112:  vm_frame_ctx_shared_args_t shared_args;
       21: 1113:  shared_args.header.status_flags = VM_FRAME_CTX_SHARED_HAS_ARG_LIST;
       21: 1114:  shared_args.header.function_object_p = func_obj_p;
       21: 1115:  shared_args.arg_list_p = arguments_list_p;
       21: 1116:  shared_args.arg_list_len = arguments_list_len;
        -: 1117:
        -: 1118:  /* Entering Function Code (ECMA-262 v5, 10.4.3) */
       21: 1119:  ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) func_obj_p;
        -: 1120:
       21: 1121:  ecma_object_t *scope_p = ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, ext_func_p->u.function.scope_cp);
        -: 1122:
        -: 1123:  /* 8. */
       21: 1124:  const ecma_compiled_code_t *bytecode_data_p = ecma_op_function_get_compiled_code (ext_func_p);
       21: 1125:  uint16_t status_flags = bytecode_data_p->status_flags;
        -: 1126:
       21: 1127:  shared_args.header.bytecode_header_p = bytecode_data_p;
        -: 1128:
        -: 1129:#if JERRY_BUILTIN_REALMS
       21: 1130:  ecma_global_object_t *realm_p = ecma_op_function_get_realm (bytecode_data_p);
        -: 1131:#endif /* JERRY_BUILTIN_REALMS */
        -: 1132:
        -: 1133:  /* 5. */
       21: 1134:  if (!(status_flags & CBC_CODE_FLAGS_LEXICAL_ENV_NOT_NEEDED))
        -: 1135:  {
        6: 1136:    shared_args.header.status_flags |= VM_FRAME_CTX_SHARED_FREE_LOCAL_ENV;
        6: 1137:    scope_p = ecma_create_decl_lex_env (scope_p);
        -: 1138:  }
        -: 1139:
        -: 1140:  /* 1. */
       21: 1141:  switch (CBC_FUNCTION_GET_TYPE (status_flags))
        -: 1142:  {
        -: 1143:#if JERRY_ESNEXT
        5: 1144:    case CBC_FUNCTION_CONSTRUCTOR:
        -: 1145:    {
        5: 1146:      return ecma_op_function_call_constructor (&shared_args, scope_p, this_binding);
        -: 1147:    }
        1: 1148:    case CBC_FUNCTION_ARROW:
        -: 1149:    {
        1: 1150:      ecma_arrow_function_t *arrow_func_p = (ecma_arrow_function_t *) func_obj_p;
        -: 1151:
        1: 1152:      if (ecma_is_value_undefined (arrow_func_p->new_target))
        -: 1153:      {
    #####: 1154:        JERRY_CONTEXT (current_new_target_p) = NULL;
        -: 1155:      }
        -: 1156:      else
        -: 1157:      {
        1: 1158:        JERRY_CONTEXT (current_new_target_p) = ecma_get_object_from_value (arrow_func_p->new_target);
        -: 1159:      }
        -: 1160:
        1: 1161:      this_binding = arrow_func_p->this_binding;
        -: 1162:
        1: 1163:      if (JERRY_UNLIKELY (this_binding == ECMA_VALUE_UNINITIALIZED))
        -: 1164:      {
        1: 1165:        ecma_environment_record_t *env_record_p = ecma_op_get_environment_record (scope_p);
        1: 1166:        JERRY_ASSERT (env_record_p);
        1: 1167:        this_binding = env_record_p->this_binding;
        -: 1168:      }
        1: 1169:      break;
        -: 1170:    }
        -: 1171:
        -: 1172:#endif /* JERRY_ESNEXT */
       15: 1173:    default:
        -: 1174:    {
        -: 1175:#if JERRY_ESNEXT
       15: 1176:      shared_args.header.status_flags |= VM_FRAME_CTX_SHARED_NON_ARROW_FUNC;
        -: 1177:#endif /* JERRY_ESNEXT */
        -: 1178:
       15: 1179:      if (status_flags & CBC_CODE_FLAGS_STRICT_MODE)
        -: 1180:      {
        1: 1181:        break;
        -: 1182:      }
        -: 1183:
       14: 1184:      if (ecma_is_value_undefined (this_binding) || ecma_is_value_null (this_binding))
        -: 1185:      {
        -: 1186:        /* 2. */
        -: 1187:#if JERRY_BUILTIN_REALMS
       14: 1188:        this_binding = realm_p->this_binding;
        -: 1189:#else /* !JERRY_BUILTIN_REALMS */
    #####: 1190:        this_binding = ecma_make_object_value (ecma_builtin_get_global ());
        -: 1191:#endif /* JERRY_BUILTIN_REALMS */
        -: 1192:      }
    #####: 1193:      else if (!ecma_is_value_object (this_binding))
        -: 1194:      {
        -: 1195:        /* 3., 4. */
    #####: 1196:        this_binding = ecma_op_to_object (this_binding);
    #####: 1197:        shared_args.header.status_flags |= VM_FRAME_CTX_SHARED_FREE_THIS;
        -: 1198:
    #####: 1199:        JERRY_ASSERT (!ECMA_IS_VALUE_ERROR (this_binding));
        -: 1200:      }
       14: 1201:      break;
        -: 1202:    }
        -: 1203:  }
        -: 1204:
        -: 1205:#if JERRY_BUILTIN_REALMS
       16: 1206:  ecma_global_object_t *saved_global_object_p = JERRY_CONTEXT (global_object_p);
       16: 1207:  JERRY_CONTEXT (global_object_p) = realm_p;
        -: 1208:#endif /* JERRY_BUILTIN_REALMS */
        -: 1209:
       16: 1210:  ecma_value_t ret_value = vm_run (&shared_args.header, this_binding, scope_p);
        -: 1211:
        -: 1212:#if JERRY_BUILTIN_REALMS
       10: 1213:  JERRY_CONTEXT (global_object_p) = saved_global_object_p;
        -: 1214:#endif /* JERRY_BUILTIN_REALMS */
        -: 1215:
       10: 1216:  if (JERRY_UNLIKELY (shared_args.header.status_flags & VM_FRAME_CTX_SHARED_FREE_LOCAL_ENV))
        -: 1217:  {
    #####: 1218:    ecma_deref_object (scope_p);
        -: 1219:  }
        -: 1220:
       10: 1221:  if (JERRY_UNLIKELY (shared_args.header.status_flags & VM_FRAME_CTX_SHARED_FREE_THIS))
        -: 1222:  {
    #####: 1223:    ecma_free_value (this_binding);
        -: 1224:  }
        -: 1225:
       10: 1226:  return ret_value;
        -: 1227:} /* ecma_op_function_call_simple */
        -: 1228:
        -: 1229:/**
        -: 1230: * Perform a built-in method call.
        -: 1231: *
        -: 1232: * @return the result of the function call.
        -: 1233: */
        -: 1234:static ecma_value_t JERRY_ATTR_NOINLINE
    #####: 1235:ecma_op_function_call_native_built_in (ecma_object_t *func_obj_p, /**< Function object */
        -: 1236:                                       ecma_value_t this_arg_value, /**< 'this' argument's value */
        -: 1237:                                       const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1238:                                       uint32_t arguments_list_len) /**< length of arguments list */
        -: 1239:{
    #####: 1240:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION);
        -: 1241:
        -: 1242:#if JERRY_BUILTIN_REALMS
    #####: 1243:  ecma_global_object_t *saved_global_object_p = JERRY_CONTEXT (global_object_p);
        -: 1244:
    #####: 1245:  ecma_extended_object_t *ext_func_obj_p = (ecma_extended_object_t *) func_obj_p;
    #####: 1246:  JERRY_CONTEXT (global_object_p) =
    #####: 1247:    ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, ext_func_obj_p->u.built_in.realm_value);
        -: 1248:#endif /* JERRY_BUILTIN_REALMS */
        -: 1249:
    #####: 1250:  ecma_value_t ret_value =
        -: 1251:    ecma_builtin_dispatch_call (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
        -: 1252:
        -: 1253:#if JERRY_BUILTIN_REALMS
    #####: 1254:  JERRY_CONTEXT (global_object_p) = saved_global_object_p;
        -: 1255:#endif /* JERRY_BUILTIN_REALMS */
    #####: 1256:  return ret_value;
        -: 1257:} /* ecma_op_function_call_native_built_in */
        -: 1258:
        -: 1259:/**
        -: 1260: * Perform a native C method call which was registered via the API.
        -: 1261: *
        -: 1262: * @return the result of the function call.
        -: 1263: */
        -: 1264:static ecma_value_t JERRY_ATTR_NOINLINE
    #####: 1265:ecma_op_function_call_native (ecma_object_t *func_obj_p, /**< Function object */
        -: 1266:                              ecma_value_t this_arg_value, /**< 'this' argument's value */
        -: 1267:                              const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1268:                              uint32_t arguments_list_len) /**< length of arguments list */
        -: 1269:{
    #####: 1270:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_NATIVE_FUNCTION);
        -: 1271:
    #####: 1272:  ecma_native_function_t *native_function_p = (ecma_native_function_t *) func_obj_p;
        -: 1273:
        -: 1274:#if JERRY_BUILTIN_REALMS
    #####: 1275:  ecma_global_object_t *saved_global_object_p = JERRY_CONTEXT (global_object_p);
    #####: 1276:  JERRY_CONTEXT (global_object_p) =
    #####: 1277:    ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, native_function_p->realm_value);
        -: 1278:#endif /* JERRY_BUILTIN_REALMS */
        -: 1279:
    #####: 1280:  jerry_call_info_t call_info;
    #####: 1281:  call_info.function = ecma_make_object_value (func_obj_p);
    #####: 1282:  call_info.this_value = this_arg_value;
        -: 1283:
        -: 1284:#if JERRY_ESNEXT
    #####: 1285:  ecma_object_t *new_target_p = JERRY_CONTEXT (current_new_target_p);
    #####: 1286:  call_info.new_target = (new_target_p == NULL) ? ECMA_VALUE_UNDEFINED : ecma_make_object_value (new_target_p);
        -: 1287:#else /* JERRY_ESNEXT */
    #####: 1288:  call_info.new_target = ECMA_VALUE_UNDEFINED;
        -: 1289:#endif /* JERRY_ESNEXT */
        -: 1290:
    #####: 1291:  JERRY_ASSERT (native_function_p->native_handler_cb != NULL);
    #####: 1292:  ecma_value_t ret_value = native_function_p->native_handler_cb (&call_info, arguments_list_p, arguments_list_len);
        -: 1293:#if JERRY_BUILTIN_REALMS
    #####: 1294:  JERRY_CONTEXT (global_object_p) = saved_global_object_p;
        -: 1295:#endif /* JERRY_BUILTIN_REALMS */
        -: 1296:
    #####: 1297:  if (JERRY_UNLIKELY (ecma_is_value_exception (ret_value)))
        -: 1298:  {
    #####: 1299:    ecma_throw_exception (ret_value);
    #####: 1300:    return ECMA_VALUE_ERROR;
        -: 1301:  }
        -: 1302:
        -: 1303:#if JERRY_DEBUGGER
        -: 1304:  JERRY_DEBUGGER_CLEAR_FLAGS (JERRY_DEBUGGER_VM_EXCEPTION_THROWN);
        -: 1305:#endif /* JERRY_DEBUGGER */
    #####: 1306:  return ret_value;
        -: 1307:} /* ecma_op_function_call_native */
        -: 1308:
        -: 1309:/**
        -: 1310: * Append the bound arguments into the given collection
        -: 1311: *
        -: 1312: * Note:
        -: 1313: *       - The whole bound chain is resolved
        -: 1314: *       - The first element of the collection contains the bounded this value
        -: 1315: *
        -: 1316: * @return target function of the bound function
        -: 1317: */
        -: 1318:JERRY_ATTR_NOINLINE static ecma_object_t *
    #####: 1319:ecma_op_bound_function_get_argument_list (ecma_object_t *func_obj_p, /**< bound bunction object */
        -: 1320:                                          ecma_collection_t *list_p) /**< list of arguments */
        -: 1321:{
    #####: 1322:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
        -: 1323:
    #####: 1324:  ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) func_obj_p;
        -: 1325:
    #####: 1326:  func_obj_p =
    #####: 1327:    ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, bound_func_p->header.u.bound_function.target_function);
        -: 1328:
    #####: 1329:  ecma_value_t args_len_or_this = bound_func_p->header.u.bound_function.args_len_or_this;
        -: 1330:
    #####: 1331:  uint32_t args_length = 1;
        -: 1332:
    #####: 1333:  if (ecma_is_value_integer_number (args_len_or_this))
        -: 1334:  {
    #####: 1335:    args_length = (uint32_t) ecma_get_integer_from_value (args_len_or_this);
        -: 1336:  }
        -: 1337:
        -: 1338:  /* 5. */
    #####: 1339:  if (args_length != 1)
        -: 1340:  {
    #####: 1341:    const ecma_value_t *args_p = (const ecma_value_t *) (bound_func_p + 1);
    #####: 1342:    list_p->buffer_p[0] = *args_p;
        -: 1343:
    #####: 1344:    if (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION)
        -: 1345:    {
    #####: 1346:      func_obj_p = ecma_op_bound_function_get_argument_list (func_obj_p, list_p);
        -: 1347:    }
    #####: 1348:    ecma_collection_append (list_p, args_p + 1, args_length - 1);
        -: 1349:  }
        -: 1350:  else
        -: 1351:  {
    #####: 1352:    list_p->buffer_p[0] = args_len_or_this;
        -: 1353:  }
        -: 1354:
    #####: 1355:  return func_obj_p;
        -: 1356:} /* ecma_op_bound_function_get_argument_list */
        -: 1357:
        -: 1358:/**
        -: 1359: * [[Call]] internal method for bound function objects
        -: 1360: *
        -: 1361: * @return ecma value
        -: 1362: *         Returned value must be freed with ecma_free_value
        -: 1363: */
        -: 1364:static ecma_value_t JERRY_ATTR_NOINLINE
    #####: 1365:ecma_op_function_call_bound (ecma_object_t *func_obj_p, /**< Function object */
        -: 1366:                             const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1367:                             uint32_t arguments_list_len) /**< length of arguments list */
        -: 1368:{
    #####: 1369:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
        -: 1370:
    #####: 1371:  JERRY_CONTEXT (status_flags) &= (uint32_t) ~ECMA_STATUS_DIRECT_EVAL;
        -: 1372:
    #####: 1373:  ecma_collection_t *bound_arg_list_p = ecma_new_collection ();
    #####: 1374:  ecma_collection_push_back (bound_arg_list_p, ECMA_VALUE_EMPTY);
        -: 1375:
    #####: 1376:  ecma_object_t *target_obj_p = ecma_op_bound_function_get_argument_list (func_obj_p, bound_arg_list_p);
        -: 1377:
    #####: 1378:  ecma_collection_append (bound_arg_list_p, arguments_list_p, arguments_list_len);
        -: 1379:
    #####: 1380:  JERRY_ASSERT (!ecma_is_value_empty (bound_arg_list_p->buffer_p[0]));
        -: 1381:
    #####: 1382:  ecma_value_t ret_value = ecma_op_function_call (target_obj_p,
    #####: 1383:                                                  bound_arg_list_p->buffer_p[0],
    #####: 1384:                                                  bound_arg_list_p->buffer_p + 1,
    #####: 1385:                                                  (uint32_t) (bound_arg_list_p->item_count - 1));
        -: 1386:
    #####: 1387:  ecma_collection_destroy (bound_arg_list_p);
        -: 1388:
    #####: 1389:  return ret_value;
        -: 1390:} /* ecma_op_function_call_bound */
        -: 1391:
        -: 1392:/**
        -: 1393: * General [[Call]] implementation
        -: 1394: *
        -: 1395: * @return ecma value
        -: 1396: *         Returned value must be freed with ecma_free_value
        -: 1397: */
        -: 1398:extern inline ecma_value_t JERRY_ATTR_ALWAYS_INLINE
       15: 1399:ecma_op_function_validated_call (ecma_value_t callee, /**< callee */
        -: 1400:                                 ecma_value_t this_arg_value, /**< 'this' argument's value */
        -: 1401:                                 const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1402:                                 uint32_t arguments_list_len) /**< length of arguments list */
        -: 1403:{
       15: 1404:  if (!ecma_is_value_object (callee))
        -: 1405:  {
    #####: 1406:    return ecma_raise_type_error (ECMA_ERR_EXPECTED_A_FUNCTION);
        -: 1407:  }
        -: 1408:
       15: 1409:  return ecma_op_function_call (ecma_get_object_from_value (callee),
        -: 1410:                                this_arg_value,
        -: 1411:                                arguments_list_p,
        -: 1412:                                arguments_list_len);
        -: 1413:} /* ecma_op_function_validated_call */
        -: 1414:
        -: 1415:/**
        -: 1416: * General [[Call]] implementation
        -: 1417: *
        -: 1418: * @return ecma value
        -: 1419: *         Returned value must be freed with ecma_free_value
        -: 1420: */
        -: 1421:ecma_value_t
       16: 1422:ecma_op_function_call (ecma_object_t *func_obj_p, /**< Function object */
        -: 1423:                       ecma_value_t this_arg_value, /**< 'this' argument's value */
        -: 1424:                       const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1425:                       uint32_t arguments_list_len) /**< length of arguments list */
        -: 1426:{
       16: 1427:  JERRY_ASSERT (func_obj_p != NULL && !ecma_is_lexical_environment (func_obj_p));
        -: 1428:
       16: 1429:  ECMA_CHECK_STACK_USAGE ();
        -: 1430:
        -: 1431:#if JERRY_ESNEXT
       16: 1432:  ecma_object_t *old_new_target_p = JERRY_CONTEXT (current_new_target_p);
        -: 1433:
       16: 1434:  if (JERRY_UNLIKELY (!(JERRY_CONTEXT (status_flags) & ECMA_STATUS_DIRECT_EVAL)))
        -: 1435:  {
       16: 1436:    JERRY_CONTEXT (current_new_target_p) = NULL;
        -: 1437:  }
        -: 1438:#endif /* JERRY_ESNEXT */
        -: 1439:
        -: 1440:  ecma_value_t result;
        -: 1441:
       16: 1442:  switch (ecma_get_object_type (func_obj_p))
        -: 1443:  {
       16: 1444:    case ECMA_OBJECT_TYPE_FUNCTION:
        -: 1445:    {
       16: 1446:      result = ecma_op_function_call_simple (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
       10: 1447:      break;
        -: 1448:    }
    #####: 1449:    case ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION:
        -: 1450:    {
    #####: 1451:      result = ecma_op_function_call_native_built_in (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
    #####: 1452:      break;
        -: 1453:    }
        -: 1454:#if JERRY_BUILTIN_PROXY
    #####: 1455:    case ECMA_OBJECT_TYPE_PROXY:
        -: 1456:    {
    #####: 1457:      result = ecma_proxy_object_call (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
    #####: 1458:      break;
        -: 1459:    }
        -: 1460:#endif /* JERRY_BUILTIN_PROXY */
        -: 1461:#if JERRY_ESNEXT
    #####: 1462:    case ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION:
        -: 1463:    {
    #####: 1464:      result = ecma_raise_type_error (ECMA_ERR_CLASS_CONSTRUCTOR_NEW);
    #####: 1465:      break;
        -: 1466:    }
        -: 1467:#endif /* JERRY_ESNEXT */
    #####: 1468:    case ECMA_OBJECT_TYPE_NATIVE_FUNCTION:
        -: 1469:    {
    #####: 1470:      result = ecma_op_function_call_native (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
    #####: 1471:      break;
        -: 1472:    }
    #####: 1473:    case ECMA_OBJECT_TYPE_BOUND_FUNCTION:
        -: 1474:    {
    #####: 1475:      result = ecma_op_function_call_bound (func_obj_p, arguments_list_p, arguments_list_len);
    #####: 1476:      break;
        -: 1477:    }
    #####: 1478:    default:
        -: 1479:    {
    #####: 1480:      result = ecma_raise_type_error (ECMA_ERR_EXPECTED_A_FUNCTION);
    #####: 1481:      break;
        -: 1482:    }
        -: 1483:  }
        -: 1484:
        -: 1485:#if JERRY_ESNEXT
       10: 1486:  JERRY_CONTEXT (current_new_target_p) = old_new_target_p;
        -: 1487:#endif /* JERRY_ESNEXT */
        -: 1488:
       10: 1489:  return result;
        -: 1490:} /* ecma_op_function_call */
        -: 1491:
        -: 1492:/**
        -: 1493: * [[Construct]] internal method for ECMAScript function objects
        -: 1494: *
        -: 1495: * @return ecma value
        -: 1496: *         Returned value must be freed with ecma_free_value
        -: 1497: */
        -: 1498:static ecma_value_t
        5: 1499:ecma_op_function_construct_simple (ecma_object_t *func_obj_p, /**< Function object */
        -: 1500:                                   ecma_object_t *new_target_p, /**< new target */
        -: 1501:                                   const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1502:                                   uint32_t arguments_list_len) /**< length of arguments list */
        -: 1503:{
        5: 1504:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_FUNCTION);
        -: 1505:
        5: 1506:  ecma_object_t *new_this_obj_p = NULL;
        -: 1507:  ecma_value_t this_arg;
        -: 1508:
        -: 1509:#if JERRY_ESNEXT
        5: 1510:  ecma_extended_object_t *ext_func_obj_p = (ecma_extended_object_t *) func_obj_p;
        -: 1511:
        -: 1512:  /* 5. */
        5: 1513:  if (!ECMA_GET_THIRD_BIT_FROM_POINTER_TAG (ext_func_obj_p->u.function.scope_cp))
        -: 1514:  {
        -: 1515:#endif /* JERRY_ESNEXT */
        -: 1516:    /* 5.a */
    #####: 1517:    ecma_object_t *proto_p = ecma_op_get_prototype_from_constructor (new_target_p, ECMA_BUILTIN_ID_OBJECT_PROTOTYPE);
        -: 1518:
        -: 1519:    /* 5.b */
    #####: 1520:    if (JERRY_UNLIKELY (proto_p == NULL))
        -: 1521:    {
    #####: 1522:      return ECMA_VALUE_ERROR;
        -: 1523:    }
        -: 1524:
    #####: 1525:    new_this_obj_p = ecma_create_object (proto_p, 0, ECMA_OBJECT_TYPE_GENERAL);
    #####: 1526:    ecma_deref_object (proto_p);
    #####: 1527:    this_arg = ecma_make_object_value (new_this_obj_p);
        -: 1528:#if JERRY_ESNEXT
        -: 1529:  }
        -: 1530:  else
        -: 1531:  {
        5: 1532:    this_arg = ECMA_VALUE_UNDEFINED;
        -: 1533:  }
        -: 1534:
        -: 1535:  /* 6. */
        5: 1536:  ecma_object_t *old_new_target_p = JERRY_CONTEXT (current_new_target_p);
        5: 1537:  JERRY_CONTEXT (current_new_target_p) = new_target_p;
        -: 1538:#endif /* JERRY_ESNEXT */
        -: 1539:
        5: 1540:  ecma_value_t ret_value = ecma_op_function_call_simple (func_obj_p, this_arg, arguments_list_p, arguments_list_len);
        -: 1541:
        -: 1542:#if JERRY_ESNEXT
        4: 1543:  JERRY_CONTEXT (current_new_target_p) = old_new_target_p;
        -: 1544:#endif /* JERRY_ESNEXT */
        -: 1545:
        -: 1546:  /* 13.a */
        4: 1547:  if (ECMA_IS_VALUE_ERROR (ret_value) || ecma_is_value_object (ret_value))
        -: 1548:  {
        -: 1549:#if JERRY_ESNEXT
        4: 1550:    if (new_this_obj_p != NULL)
        -: 1551:    {
    #####: 1552:      ecma_deref_object (new_this_obj_p);
        -: 1553:    }
        -: 1554:#else /* !JERRY_ESNEXT */
    #####: 1555:    ecma_deref_object (new_this_obj_p);
        -: 1556:#endif /* JERRY_ESNEXT */
        4: 1557:    return ret_value;
        -: 1558:  }
        -: 1559:
        -: 1560:  /* 13.b */
    #####: 1561:  ecma_free_value (ret_value);
    #####: 1562:  return this_arg;
        -: 1563:} /* ecma_op_function_construct_simple */
        -: 1564:
        -: 1565:/**
        -: 1566: * [[Construct]] internal method for built-in function objects
        -: 1567: *
        -: 1568: * @return ecma value
        -: 1569: *         Returned value must be freed with ecma_free_value
        -: 1570: */
        -: 1571:static ecma_value_t
    #####: 1572:ecma_op_function_construct_built_in (ecma_object_t *func_obj_p, /**< Function object */
        -: 1573:                                     ecma_object_t *new_target_p, /**< new target */
        -: 1574:                                     const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1575:                                     uint32_t arguments_list_len) /**< length of arguments list */
        -: 1576:{
        -: 1577:  JERRY_UNUSED (new_target_p);
        -: 1578:
    #####: 1579:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION);
        -: 1580:
        -: 1581:#if JERRY_BUILTIN_REALMS
    #####: 1582:  ecma_global_object_t *saved_global_object_p = JERRY_CONTEXT (global_object_p);
    #####: 1583:  ecma_value_t realm_value = ((ecma_extended_object_t *) func_obj_p)->u.built_in.realm_value;
    #####: 1584:  JERRY_CONTEXT (global_object_p) = ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, realm_value);
        -: 1585:#endif /* JERRY_BUILTIN_REALMS */
        -: 1586:
        -: 1587:#if JERRY_ESNEXT
    #####: 1588:  ecma_object_t *old_new_target = JERRY_CONTEXT (current_new_target_p);
    #####: 1589:  JERRY_CONTEXT (current_new_target_p) = new_target_p;
        -: 1590:#endif /* JERRY_ESNEXT */
        -: 1591:
    #####: 1592:  ecma_value_t ret_value = ecma_builtin_dispatch_construct (func_obj_p, arguments_list_p, arguments_list_len);
        -: 1593:
        -: 1594:#if JERRY_ESNEXT
    #####: 1595:  JERRY_CONTEXT (current_new_target_p) = old_new_target;
        -: 1596:#endif /* JERRY_ESNEXT */
        -: 1597:
        -: 1598:#if JERRY_BUILTIN_REALMS
    #####: 1599:  JERRY_CONTEXT (global_object_p) = saved_global_object_p;
        -: 1600:#endif /* JERRY_BUILTIN_REALMS */
    #####: 1601:  return ret_value;
        -: 1602:} /* ecma_op_function_construct_built_in */
        -: 1603:
        -: 1604:/**
        -: 1605: * [[Construct]] internal method for bound function objects
        -: 1606: *
        -: 1607: * @return ecma value
        -: 1608: *         Returned value must be freed with ecma_free_value
        -: 1609: */
        -: 1610:static ecma_value_t JERRY_ATTR_NOINLINE
    #####: 1611:ecma_op_function_construct_bound (ecma_object_t *func_obj_p, /**< Function object */
        -: 1612:                                  ecma_object_t *new_target_p, /**< new target */
        -: 1613:                                  const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1614:                                  uint32_t arguments_list_len) /**< length of arguments list */
        -: 1615:{
    #####: 1616:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
        -: 1617:
    #####: 1618:  ecma_collection_t *bound_arg_list_p = ecma_new_collection ();
    #####: 1619:  ecma_collection_push_back (bound_arg_list_p, ECMA_VALUE_EMPTY);
        -: 1620:
    #####: 1621:  ecma_object_t *target_obj_p = ecma_op_bound_function_get_argument_list (func_obj_p, bound_arg_list_p);
        -: 1622:
    #####: 1623:  ecma_collection_append (bound_arg_list_p, arguments_list_p, arguments_list_len);
        -: 1624:
    #####: 1625:  if (func_obj_p == new_target_p)
        -: 1626:  {
    #####: 1627:    new_target_p = target_obj_p;
        -: 1628:  }
        -: 1629:
    #####: 1630:  ecma_value_t ret_value = ecma_op_function_construct (target_obj_p,
        -: 1631:                                                       new_target_p,
    #####: 1632:                                                       bound_arg_list_p->buffer_p + 1,
    #####: 1633:                                                       (uint32_t) (bound_arg_list_p->item_count - 1));
        -: 1634:
    #####: 1635:  ecma_collection_destroy (bound_arg_list_p);
        -: 1636:
    #####: 1637:  return ret_value;
        -: 1638:} /* ecma_op_function_construct_bound */
        -: 1639:
        -: 1640:#if JERRY_ESNEXT
        -: 1641:
        -: 1642:/**
        -: 1643: * [[Construct]] internal method for class implicit constructor objects
        -: 1644: *
        -: 1645: * @return ecma value
        -: 1646: *         Returned value must be freed with ecma_free_value
        -: 1647: */
        -: 1648:static ecma_value_t
    #####: 1649:ecma_op_function_construct_constructor (ecma_object_t *func_obj_p, /**< Function object */
        -: 1650:                                        ecma_object_t *new_target_p, /**< new target */
        -: 1651:                                        const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1652:                                        uint32_t arguments_list_len) /**< length of arguments list */
        -: 1653:{
    #####: 1654:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION);
        -: 1655:
    #####: 1656:  ecma_extended_object_t *constructor_object_p = (ecma_extended_object_t *) func_obj_p;
        -: 1657:
    #####: 1658:  if (!(constructor_object_p->u.constructor_function.flags & ECMA_CONSTRUCTOR_FUNCTION_HAS_HERITAGE))
        -: 1659:  {
    #####: 1660:    ecma_object_t *proto_p = ecma_op_get_prototype_from_constructor (new_target_p, ECMA_BUILTIN_ID_OBJECT_PROTOTYPE);
        -: 1661:
    #####: 1662:    if (JERRY_UNLIKELY (proto_p == NULL))
        -: 1663:    {
    #####: 1664:      return ECMA_VALUE_ERROR;
        -: 1665:    }
        -: 1666:
    #####: 1667:    ecma_object_t *new_this_object_p = ecma_create_object (proto_p, 0, ECMA_OBJECT_TYPE_GENERAL);
    #####: 1668:    ecma_deref_object (proto_p);
        -: 1669:
    #####: 1670:    jerry_value_t new_this_value = ecma_make_object_value (new_this_object_p);
    #####: 1671:    jerry_value_t ret_value = opfunc_init_class_fields (func_obj_p, new_this_value);
        -: 1672:
    #####: 1673:    if (ECMA_IS_VALUE_ERROR (ret_value))
        -: 1674:    {
    #####: 1675:      ecma_deref_object (new_this_object_p);
    #####: 1676:      return ret_value;
        -: 1677:    }
        -: 1678:
    #####: 1679:    return new_this_value;
        -: 1680:  }
        -: 1681:
    #####: 1682:  ecma_value_t super_ctor = ecma_op_function_get_super_constructor (func_obj_p);
        -: 1683:
    #####: 1684:  if (ECMA_IS_VALUE_ERROR (super_ctor))
        -: 1685:  {
    #####: 1686:    return super_ctor;
        -: 1687:  }
        -: 1688:
    #####: 1689:  ecma_object_t *super_ctor_p = ecma_get_object_from_value (super_ctor);
    #####: 1690:  ecma_value_t result = ecma_op_function_construct (super_ctor_p, new_target_p, arguments_list_p, arguments_list_len);
    #####: 1691:  ecma_deref_object (super_ctor_p);
        -: 1692:
    #####: 1693:  if (ecma_is_value_object (result))
        -: 1694:  {
    #####: 1695:    ecma_value_t fields_value = opfunc_init_class_fields (func_obj_p, result);
        -: 1696:
    #####: 1697:    if (ECMA_IS_VALUE_ERROR (fields_value))
        -: 1698:    {
    #####: 1699:      ecma_free_value (result);
    #####: 1700:      return fields_value;
        -: 1701:    }
        -: 1702:  }
        -: 1703:
    #####: 1704:  return result;
        -: 1705:} /* ecma_op_function_construct_constructor */
        -: 1706:
        -: 1707:#endif /* JERRY_ESNEXT */
        -: 1708:
        -: 1709:/**
        -: 1710: * [[Construct]] internal method for external function objects
        -: 1711: *
        -: 1712: * @return ecma value
        -: 1713: *         Returned value must be freed with ecma_free_value
        -: 1714: */
        -: 1715:static ecma_value_t
    #####: 1716:ecma_op_function_construct_native (ecma_object_t *func_obj_p, /**< Function object */
        -: 1717:                                   ecma_object_t *new_target_p, /**< new target */
        -: 1718:                                   const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1719:                                   uint32_t arguments_list_len) /**< length of arguments list */
        -: 1720:{
    #####: 1721:  JERRY_ASSERT (ecma_get_object_type (func_obj_p) == ECMA_OBJECT_TYPE_NATIVE_FUNCTION);
        -: 1722:
    #####: 1723:  ecma_object_t *proto_p = ecma_op_get_prototype_from_constructor (new_target_p, ECMA_BUILTIN_ID_OBJECT_PROTOTYPE);
        -: 1724:
    #####: 1725:  if (JERRY_UNLIKELY (proto_p == NULL))
        -: 1726:  {
    #####: 1727:    return ECMA_VALUE_ERROR;
        -: 1728:  }
        -: 1729:
    #####: 1730:  ecma_object_t *new_this_obj_p = ecma_create_object (proto_p, 0, ECMA_OBJECT_TYPE_GENERAL);
    #####: 1731:  ecma_value_t this_arg = ecma_make_object_value (new_this_obj_p);
    #####: 1732:  ecma_deref_object (proto_p);
        -: 1733:
        -: 1734:#if JERRY_ESNEXT
    #####: 1735:  ecma_object_t *old_new_target_p = JERRY_CONTEXT (current_new_target_p);
    #####: 1736:  JERRY_CONTEXT (current_new_target_p) = new_target_p;
        -: 1737:#endif /* JERRY_ESNEXT */
        -: 1738:
    #####: 1739:  ecma_value_t ret_value = ecma_op_function_call_native (func_obj_p, this_arg, arguments_list_p, arguments_list_len);
        -: 1740:
        -: 1741:#if JERRY_ESNEXT
    #####: 1742:  JERRY_CONTEXT (current_new_target_p) = old_new_target_p;
        -: 1743:#endif /* JERRY_ESNEXT */
        -: 1744:
    #####: 1745:  if (ECMA_IS_VALUE_ERROR (ret_value) || ecma_is_value_object (ret_value))
        -: 1746:  {
    #####: 1747:    ecma_deref_object (new_this_obj_p);
    #####: 1748:    return ret_value;
        -: 1749:  }
        -: 1750:
    #####: 1751:  ecma_free_value (ret_value);
        -: 1752:
    #####: 1753:  return this_arg;
        -: 1754:} /* ecma_op_function_construct_native */
        -: 1755:
        -: 1756:/**
        -: 1757: * General [[Construct]] implementation function objects
        -: 1758: *
        -: 1759: * See also: ECMAScript v6, 9.2.2
        -: 1760: *
        -: 1761: * @return ecma value
        -: 1762: *         Returned value must be freed with ecma_free_value
        -: 1763: */
        -: 1764:ecma_value_t
        5: 1765:ecma_op_function_construct (ecma_object_t *func_obj_p, /**< Function object */
        -: 1766:                            ecma_object_t *new_target_p, /**< new target */
        -: 1767:                            const ecma_value_t *arguments_list_p, /**< arguments list */
        -: 1768:                            uint32_t arguments_list_len) /**< length of arguments list */
        -: 1769:{
        5: 1770:  JERRY_ASSERT (func_obj_p != NULL && !ecma_is_lexical_environment (func_obj_p));
        -: 1771:
        5: 1772:  switch (ecma_get_object_type (func_obj_p))
        -: 1773:  {
        5: 1774:    case ECMA_OBJECT_TYPE_FUNCTION:
        -: 1775:    {
        5: 1776:      return ecma_op_function_construct_simple (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1777:    }
    #####: 1778:    case ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION:
        -: 1779:    {
    #####: 1780:      return ecma_op_function_construct_built_in (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1781:    }
        -: 1782:#if JERRY_BUILTIN_PROXY
    #####: 1783:    case ECMA_OBJECT_TYPE_PROXY:
        -: 1784:    {
    #####: 1785:      return ecma_proxy_object_construct (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1786:    }
        -: 1787:#endif /* JERRY_BUILTIN_PROXY */
        -: 1788:#if JERRY_ESNEXT
    #####: 1789:    case ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION:
        -: 1790:    {
    #####: 1791:      return ecma_op_function_construct_constructor (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1792:    }
        -: 1793:#endif /* JERRY_ESNEXT */
    #####: 1794:    case ECMA_OBJECT_TYPE_BOUND_FUNCTION:
        -: 1795:    {
    #####: 1796:      return ecma_op_function_construct_bound (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1797:    }
    #####: 1798:    case ECMA_OBJECT_TYPE_NATIVE_FUNCTION:
        -: 1799:    {
    #####: 1800:      return ecma_op_function_construct_native (func_obj_p, new_target_p, arguments_list_p, arguments_list_len);
        -: 1801:    }
    #####: 1802:    default:
        -: 1803:    {
    #####: 1804:      JERRY_UNREACHABLE ();
        -: 1805:    }
        -: 1806:  }
        -: 1807:
        -: 1808:  return ECMA_VALUE_UNDEFINED;
        -: 1809:} /* ecma_op_function_construct */
        -: 1810:
        -: 1811:/**
        -: 1812: * Lazy instantiation of 'prototype' property for non-builtin and external functions
        -: 1813: *
        -: 1814: * @return pointer to newly instantiated property
        -: 1815: */
        -: 1816:static ecma_property_t *
    #####: 1817:ecma_op_lazy_instantiate_prototype_object (ecma_object_t *object_p) /**< the function object */
        -: 1818:{
    #####: 1819:  JERRY_ASSERT (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_FUNCTION
        -: 1820:                || ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_NATIVE_FUNCTION);
        -: 1821:
        -: 1822:#if JERRY_BUILTIN_REALMS
        -: 1823:  ecma_global_object_t *global_object_p;
        -: 1824:
    #####: 1825:  if (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_FUNCTION)
        -: 1826:  {
        -: 1827:    const ecma_compiled_code_t *bytecode_data_p;
    #####: 1828:    bytecode_data_p = ecma_op_function_get_compiled_code ((ecma_extended_object_t *) object_p);
        -: 1829:
    #####: 1830:    global_object_p = ecma_op_function_get_realm (bytecode_data_p);
        -: 1831:  }
        -: 1832:  else
        -: 1833:  {
    #####: 1834:    ecma_native_function_t *native_function_p = (ecma_native_function_t *) object_p;
        -: 1835:
    #####: 1836:    global_object_p = ECMA_GET_INTERNAL_VALUE_POINTER (ecma_global_object_t, native_function_p->realm_value);
        -: 1837:  }
        -: 1838:#endif /* JERRY_BUILTIN_REALMS */
        -: 1839:
        -: 1840:  /* ECMA-262 v5, 13.2, 16-18 */
        -: 1841:
    #####: 1842:  ecma_object_t *proto_object_p = NULL;
    #####: 1843:  bool init_constructor = true;
        -: 1844:
        -: 1845:#if JERRY_ESNEXT
    #####: 1846:  if (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_FUNCTION)
        -: 1847:  {
    #####: 1848:    const ecma_compiled_code_t *byte_code_p = ecma_op_function_get_compiled_code ((ecma_extended_object_t *) object_p);
        -: 1849:
    #####: 1850:    if (!CBC_FUNCTION_HAS_PROTOTYPE (byte_code_p->status_flags))
        -: 1851:    {
    #####: 1852:      return NULL;
        -: 1853:    }
        -: 1854:
    #####: 1855:    if (CBC_FUNCTION_GET_TYPE (byte_code_p->status_flags) == CBC_FUNCTION_GENERATOR)
        -: 1856:    {
        -: 1857:      ecma_object_t *prototype_p;
        -: 1858:
        -: 1859:#if JERRY_BUILTIN_REALMS
    #####: 1860:      prototype_p = ecma_builtin_get_from_realm (global_object_p, ECMA_BUILTIN_ID_GENERATOR_PROTOTYPE);
        -: 1861:#else /* !JERRY_BUILTIN_REALMS */
        -: 1862:      prototype_p = ecma_builtin_get (ECMA_BUILTIN_ID_GENERATOR_PROTOTYPE);
        -: 1863:#endif /* JERRY_BUILTIN_REALMS */
        -: 1864:
    #####: 1865:      proto_object_p = ecma_create_object (prototype_p, 0, ECMA_OBJECT_TYPE_GENERAL);
    #####: 1866:      init_constructor = false;
        -: 1867:    }
        -: 1868:
    #####: 1869:    if (CBC_FUNCTION_GET_TYPE (byte_code_p->status_flags) == CBC_FUNCTION_ASYNC_GENERATOR)
        -: 1870:    {
        -: 1871:      ecma_object_t *prototype_p;
        -: 1872:
        -: 1873:#if JERRY_BUILTIN_REALMS
    #####: 1874:      prototype_p = ecma_builtin_get_from_realm (global_object_p, ECMA_BUILTIN_ID_ASYNC_GENERATOR_PROTOTYPE);
        -: 1875:#else /* !JERRY_BUILTIN_REALMS */
        -: 1876:      prototype_p = ecma_builtin_get (ECMA_BUILTIN_ID_ASYNC_GENERATOR_PROTOTYPE);
        -: 1877:#endif /* JERRY_BUILTIN_REALMS */
        -: 1878:
    #####: 1879:      proto_object_p = ecma_create_object (prototype_p, 0, ECMA_OBJECT_TYPE_GENERAL);
    #####: 1880:      init_constructor = false;
        -: 1881:    }
        -: 1882:  }
        -: 1883:#endif /* JERRY_ESNEXT */
        -: 1884:
        -: 1885:#if JERRY_ESNEXT
    #####: 1886:  if (proto_object_p == NULL)
        -: 1887:#endif /* JERRY_ESNEXT */
        -: 1888:  {
        -: 1889:    ecma_object_t *prototype_p;
        -: 1890:
        -: 1891:#if JERRY_BUILTIN_REALMS
    #####: 1892:    prototype_p = ecma_builtin_get_from_realm (global_object_p, ECMA_BUILTIN_ID_OBJECT_PROTOTYPE);
        -: 1893:#else /* !JERRY_BUILTIN_REALMS */
    #####: 1894:    prototype_p = ecma_builtin_get (ECMA_BUILTIN_ID_OBJECT_PROTOTYPE);
        -: 1895:#endif /* JERRY_BUILTIN_REALMS */
        -: 1896:
    #####: 1897:    proto_object_p = ecma_op_create_object_object_noarg_and_set_prototype (prototype_p);
        -: 1898:  }
        -: 1899:
        -: 1900:  /* 17. */
    #####: 1901:  if (init_constructor)
        -: 1902:  {
        -: 1903:    ecma_property_value_t *constructor_prop_value_p;
    #####: 1904:    constructor_prop_value_p = ecma_create_named_data_property (proto_object_p,
        -: 1905:                                                                ecma_get_magic_string (LIT_MAGIC_STRING_CONSTRUCTOR),
        -: 1906:                                                                ECMA_PROPERTY_CONFIGURABLE_WRITABLE,
        -: 1907:                                                                NULL);
        -: 1908:
    #####: 1909:    constructor_prop_value_p->value = ecma_make_object_value (object_p);
        -: 1910:  }
        -: 1911:
        -: 1912:  /* 18. */
    #####: 1913:  ecma_property_t *prototype_prop_p;
        -: 1914:  ecma_property_value_t *prototype_prop_value_p;
    #####: 1915:  prototype_prop_value_p = ecma_create_named_data_property (object_p,
        -: 1916:                                                            ecma_get_magic_string (LIT_MAGIC_STRING_PROTOTYPE),
        -: 1917:                                                            ECMA_PROPERTY_BUILT_IN_WRITABLE,
        -: 1918:                                                            &prototype_prop_p);
        -: 1919:
    #####: 1920:  prototype_prop_value_p->value = ecma_make_object_value (proto_object_p);
        -: 1921:
    #####: 1922:  ecma_deref_object (proto_object_p);
        -: 1923:
    #####: 1924:  return prototype_prop_p;
        -: 1925:} /* ecma_op_lazy_instantiate_prototype_object */
        -: 1926:
        -: 1927:/**
        -: 1928: * Lazy instantiation of non-builtin ecma function object's properties
        -: 1929: *
        -: 1930: * Warning:
        -: 1931: *         Only non-configurable properties could be instantiated lazily in this function,
        -: 1932: *         as configurable properties could be deleted and it would be incorrect
        -: 1933: *         to reinstantiate them in the function in second time.
        -: 1934: *
        -: 1935: * @return pointer to newly instantiated property, if a property was instantiated,
        -: 1936: *         NULL - otherwise
        -: 1937: */
        -: 1938:ecma_property_t *
    #####: 1939:ecma_op_function_try_to_lazy_instantiate_property (ecma_object_t *object_p, /**< the function object */
        -: 1940:                                                   ecma_string_t *property_name_p) /**< property name */
        -: 1941:{
    #####: 1942:  JERRY_ASSERT (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_FUNCTION);
        -: 1943:
        -: 1944:#if JERRY_ESNEXT
    #####: 1945:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_LENGTH))
        -: 1946:  {
    #####: 1947:    ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) object_p;
        -: 1948:
    #####: 1949:    if (ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp))
        -: 1950:    {
    #####: 1951:      return NULL;
        -: 1952:    }
        -: 1953:
        -: 1954:    /* Initialize 'length' property */
    #####: 1955:    const ecma_compiled_code_t *bytecode_data_p = ecma_op_function_get_compiled_code (ext_func_p);
        -: 1956:    uint32_t len;
        -: 1957:
    #####: 1958:    if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_UINT16_ARGUMENTS)
        -: 1959:    {
    #####: 1960:      cbc_uint16_arguments_t *args_p = (cbc_uint16_arguments_t *) bytecode_data_p;
    #####: 1961:      len = args_p->argument_end;
        -: 1962:    }
        -: 1963:    else
        -: 1964:    {
    #####: 1965:      cbc_uint8_arguments_t *args_p = (cbc_uint8_arguments_t *) bytecode_data_p;
    #####: 1966:      len = args_p->argument_end;
        -: 1967:    }
        -: 1968:
    #####: 1969:    if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_HAS_EXTENDED_INFO)
        -: 1970:    {
    #####: 1971:      uint8_t *extended_info_p = ecma_compiled_code_resolve_extended_info (bytecode_data_p);
        -: 1972:
    #####: 1973:      if (*extended_info_p & CBC_EXTENDED_CODE_FLAGS_HAS_ARGUMENT_LENGTH)
        -: 1974:      {
    #####: 1975:        len = ecma_extended_info_decode_vlq (&extended_info_p);
        -: 1976:      }
        -: 1977:    }
        -: 1978:
    #####: 1979:    ecma_property_t *value_prop_p;
    #####: 1980:    ecma_property_value_t *value_p =
        -: 1981:      ecma_create_named_data_property (object_p, property_name_p, ECMA_PROPERTY_BUILT_IN_CONFIGURABLE, &value_prop_p);
    #####: 1982:    value_p->value = ecma_make_uint32_value (len);
    #####: 1983:    return value_prop_p;
        -: 1984:  }
        -: 1985:
    #####: 1986:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_NAME))
        -: 1987:  {
    #####: 1988:    ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) object_p;
        -: 1989:
    #####: 1990:    if (ECMA_GET_SECOND_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp))
        -: 1991:    {
    #####: 1992:      return NULL;
        -: 1993:    }
        -: 1994:
    #####: 1995:    const ecma_compiled_code_t *bytecode_data_p = ecma_op_function_get_compiled_code (ext_func_p);
        -: 1996:
    #####: 1997:    if (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) == CBC_FUNCTION_CONSTRUCTOR)
        -: 1998:    {
    #####: 1999:      return NULL;
        -: 2000:    }
        -: 2001:
    #####: 2002:    ecma_value_t value = *ecma_compiled_code_resolve_function_name (bytecode_data_p);
    #####: 2003:    JERRY_ASSERT (ecma_is_value_string (value));
        -: 2004:
        -: 2005:    /* Initialize 'name' property */
    #####: 2006:    ecma_property_t *value_prop_p;
    #####: 2007:    ecma_property_value_t *value_p =
        -: 2008:      ecma_create_named_data_property (object_p, property_name_p, ECMA_PROPERTY_BUILT_IN_CONFIGURABLE, &value_prop_p);
    #####: 2009:    value_p->value = ecma_copy_value (value);
    #####: 2010:    return value_prop_p;
        -: 2011:  }
        -: 2012:#endif /* JERRY_ESNEXT */
        -: 2013:
    #####: 2014:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_PROTOTYPE)
    #####: 2015:      && ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_FUNCTION)
        -: 2016:  {
    #####: 2017:    return ecma_op_lazy_instantiate_prototype_object (object_p);
        -: 2018:  }
        -: 2019:
    #####: 2020:  const bool is_arguments = ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_ARGUMENTS);
        -: 2021:
    #####: 2022:  if (is_arguments || ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_CALLER))
        -: 2023:  {
        -: 2024:    const ecma_compiled_code_t *bytecode_data_p;
    #####: 2025:    bytecode_data_p = ecma_op_function_get_compiled_code ((ecma_extended_object_t *) object_p);
        -: 2026:
        -: 2027:#if JERRY_ESNEXT
    #####: 2028:    if (!(bytecode_data_p->status_flags & CBC_CODE_FLAGS_STRICT_MODE)
    #####: 2029:        && CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) == CBC_FUNCTION_NORMAL)
        -: 2030:    {
    #####: 2031:      ecma_property_t *value_prop_p;
        -: 2032:      /* The property_name_p argument contains the name. */
    #####: 2033:      ecma_property_value_t *value_p =
        -: 2034:        ecma_create_named_data_property (object_p, property_name_p, ECMA_PROPERTY_BUILT_IN_FIXED, &value_prop_p);
    #####: 2035:      value_p->value = is_arguments ? ECMA_VALUE_NULL : ECMA_VALUE_UNDEFINED;
    #####: 2036:      return value_prop_p;
        -: 2037:    }
        -: 2038:#else /* !JERRY_ESNEXT */
    #####: 2039:    if (bytecode_data_p->status_flags & CBC_CODE_FLAGS_STRICT_MODE)
        -: 2040:    {
    #####: 2041:      ecma_object_t *thrower_p = ecma_builtin_get (ECMA_BUILTIN_ID_TYPE_ERROR_THROWER);
        -: 2042:
        -: 2043:      ecma_property_t *caller_prop_p;
        -: 2044:      /* The property_name_p argument contains the name. */
    #####: 2045:      ecma_create_named_accessor_property (object_p,
        -: 2046:                                           property_name_p,
        -: 2047:                                           thrower_p,
        -: 2048:                                           thrower_p,
        -: 2049:                                           ECMA_PROPERTY_BUILT_IN_FIXED,
        -: 2050:                                           &caller_prop_p);
    #####: 2051:      return caller_prop_p;
        -: 2052:    }
        -: 2053:#endif /* JERRY_ESNEXT */
        -: 2054:  }
        -: 2055:
    #####: 2056:  return NULL;
        -: 2057:} /* ecma_op_function_try_to_lazy_instantiate_property */
        -: 2058:
        -: 2059:/**
        -: 2060: * Create specification defined non-configurable properties for external functions.
        -: 2061: *
        -: 2062: * See also:
        -: 2063: *          ECMA-262 v5, 15.3.4.5
        -: 2064: *
        -: 2065: * @return pointer property, if one was instantiated,
        -: 2066: *         NULL - otherwise.
        -: 2067: */
        -: 2068:ecma_property_t *
    #####: 2069:ecma_op_external_function_try_to_lazy_instantiate_property (ecma_object_t *object_p, /**< object */
        -: 2070:                                                            ecma_string_t *property_name_p) /**< property's name */
        -: 2071:{
    #####: 2072:  JERRY_ASSERT (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_NATIVE_FUNCTION);
        -: 2073:
    #####: 2074:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_PROTOTYPE))
        -: 2075:  {
    #####: 2076:    return ecma_op_lazy_instantiate_prototype_object (object_p);
        -: 2077:  }
        -: 2078:
    #####: 2079:  return NULL;
        -: 2080:} /* ecma_op_external_function_try_to_lazy_instantiate_property */
        -: 2081:
        -: 2082:/**
        -: 2083: * Create specification defined non-configurable properties for bound functions.
        -: 2084: *
        -: 2085: * See also:
        -: 2086: *          ECMA-262 v5, 15.3.4.5
        -: 2087: *
        -: 2088: * @return pointer property, if one was instantiated,
        -: 2089: *         NULL - otherwise.
        -: 2090: */
        -: 2091:ecma_property_t *
    #####: 2092:ecma_op_bound_function_try_to_lazy_instantiate_property (ecma_object_t *object_p, /**< object */
        -: 2093:                                                         ecma_string_t *property_name_p) /**< property's name */
        -: 2094:{
    #####: 2095:  JERRY_ASSERT (ecma_get_object_type (object_p) == ECMA_OBJECT_TYPE_BOUND_FUNCTION);
        -: 2096:
    #####: 2097:  if (ecma_string_is_length (property_name_p))
        -: 2098:  {
    #####: 2099:    ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) object_p;
    #####: 2100:    ecma_value_t args_len_or_this = bound_func_p->header.u.bound_function.args_len_or_this;
    #####: 2101:    ecma_number_t length = 0;
    #####: 2102:    ecma_integer_value_t args_length = 1;
        -: 2103:    uint8_t length_attributes;
        -: 2104:
    #####: 2105:    if (ecma_is_value_integer_number (args_len_or_this))
        -: 2106:    {
    #####: 2107:      args_length = ecma_get_integer_from_value (args_len_or_this);
        -: 2108:    }
        -: 2109:
        -: 2110:#if JERRY_ESNEXT
    #####: 2111:    if (ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (bound_func_p->header.u.bound_function.target_function))
        -: 2112:    {
    #####: 2113:      return NULL;
        -: 2114:    }
        -: 2115:
    #####: 2116:    length_attributes = ECMA_PROPERTY_BUILT_IN_CONFIGURABLE;
    #####: 2117:    length = ecma_get_number_from_value (bound_func_p->target_length) - (args_length - 1);
        -: 2118:#else /* !JERRY_ESNEXT */
    #####: 2119:    length_attributes = ECMA_PROPERTY_BUILT_IN_FIXED;
        -: 2120:
        -: 2121:    ecma_object_t *target_func_p;
    #####: 2122:    target_func_p =
    #####: 2123:      ECMA_GET_NON_NULL_POINTER_FROM_POINTER_TAG (ecma_object_t, bound_func_p->header.u.bound_function.target_function);
        -: 2124:
    #####: 2125:    if (ecma_object_get_class_name (target_func_p) == LIT_MAGIC_STRING_FUNCTION_UL)
        -: 2126:    {
        -: 2127:      /* The property_name_p argument contains the 'length' string. */
    #####: 2128:      ecma_value_t get_len_value = ecma_op_object_get (target_func_p, property_name_p);
        -: 2129:
        -: 2130:      JERRY_ASSERT (!ECMA_IS_VALUE_ERROR (get_len_value));
        -: 2131:      JERRY_ASSERT (ecma_is_value_integer_number (get_len_value));
        -: 2132:
    #####: 2133:      length = (ecma_number_t) (ecma_get_integer_from_value (get_len_value) - (args_length - 1));
        -: 2134:    }
        -: 2135:#endif /* JERRY_ESNEXT */
        -: 2136:
    #####: 2137:    if (length < 0)
        -: 2138:    {
    #####: 2139:      length = 0;
        -: 2140:    }
        -: 2141:
    #####: 2142:    ecma_property_t *len_prop_p;
    #####: 2143:    ecma_property_value_t *len_prop_value_p =
    #####: 2144:      ecma_create_named_data_property (object_p, property_name_p, length_attributes, &len_prop_p);
        -: 2145:
    #####: 2146:    len_prop_value_p->value = ecma_make_number_value (length);
    #####: 2147:    return len_prop_p;
        -: 2148:  }
        -: 2149:
        -: 2150:#if !JERRY_ESNEXT
    #####: 2151:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_CALLER)
    #####: 2152:      || ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_ARGUMENTS))
        -: 2153:  {
    #####: 2154:    ecma_object_t *thrower_p = ecma_builtin_get (ECMA_BUILTIN_ID_TYPE_ERROR_THROWER);
        -: 2155:
        -: 2156:    ecma_property_t *caller_prop_p;
        -: 2157:    /* The string_p argument contans the name. */
    #####: 2158:    ecma_create_named_accessor_property (object_p,
        -: 2159:                                         property_name_p,
        -: 2160:                                         thrower_p,
        -: 2161:                                         thrower_p,
        -: 2162:                                         ECMA_PROPERTY_BUILT_IN_FIXED,
        -: 2163:                                         &caller_prop_p);
    #####: 2164:    return caller_prop_p;
        -: 2165:  }
        -: 2166:#endif /* !JERRY_ESNEXT */
        -: 2167:
    #####: 2168:  return NULL;
        -: 2169:} /* ecma_op_bound_function_try_to_lazy_instantiate_property */
        -: 2170:
        -: 2171:#if JERRY_ESNEXT
        -: 2172:
        -: 2173:/**
        -: 2174: * Delete configurable properties of functions.
        -: 2175: */
        -: 2176:void
    #####: 2177:ecma_op_function_delete_built_in_property (ecma_object_t *object_p, /**< object */
        -: 2178:                                           ecma_string_t *property_name_p) /**< property name */
        -: 2179:{
    #####: 2180:  ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) object_p;
        -: 2181:
    #####: 2182:  if (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_LENGTH))
        -: 2183:  {
    #####: 2184:    JERRY_ASSERT (!ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp));
    #####: 2185:    ECMA_SET_FIRST_BIT_TO_POINTER_TAG (ext_func_p->u.function.scope_cp);
    #####: 2186:    return;
        -: 2187:  }
        -: 2188:
    #####: 2189:  JERRY_ASSERT (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_NAME));
    #####: 2190:  JERRY_ASSERT (!ECMA_GET_SECOND_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp));
        -: 2191:
    #####: 2192:  ECMA_SET_SECOND_BIT_TO_POINTER_TAG (ext_func_p->u.function.scope_cp);
        -: 2193:} /* ecma_op_function_delete_built_in_property */
        -: 2194:
        -: 2195:/**
        -: 2196: * Delete configurable properties of bound functions.
        -: 2197: */
        -: 2198:void
    #####: 2199:ecma_op_bound_function_delete_built_in_property (ecma_object_t *object_p, /**< object */
        -: 2200:                                                 ecma_string_t *property_name_p) /**< property name */
        -: 2201:{
        -: 2202:  JERRY_UNUSED (property_name_p);
        -: 2203:
    #####: 2204:  ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) object_p;
        -: 2205:
    #####: 2206:  JERRY_ASSERT (ecma_compare_ecma_string_to_magic_id (property_name_p, LIT_MAGIC_STRING_LENGTH));
    #####: 2207:  JERRY_ASSERT (!ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (bound_func_p->header.u.bound_function.target_function));
        -: 2208:
    #####: 2209:  ECMA_SET_FIRST_BIT_TO_POINTER_TAG (bound_func_p->header.u.bound_function.target_function);
    #####: 2210:} /* ecma_op_bound_function_delete_built_in_property */
        -: 2211:
        -: 2212:#endif /* JERRY_ESNEXT */
        -: 2213:
        -: 2214:/**
        -: 2215: * List names of a Function object's lazy instantiated properties,
        -: 2216: * adding them to corresponding string collections
        -: 2217: *
        -: 2218: * See also:
        -: 2219: *          ecma_op_function_try_to_lazy_instantiate_property
        -: 2220: */
        -: 2221:void
    #####: 2222:ecma_op_function_list_lazy_property_names (ecma_object_t *object_p, /**< functionobject */
        -: 2223:                                           ecma_collection_t *prop_names_p, /**< prop name collection */
        -: 2224:                                           ecma_property_counter_t *prop_counter_p, /**< property counters */
        -: 2225:                                           jerry_property_filter_t filter) /**< property name filter options */
        -: 2226:{
    #####: 2227:  if (filter & JERRY_PROPERTY_FILTER_EXCLUDE_STRINGS)
        -: 2228:  {
    #####: 2229:    return;
        -: 2230:  }
        -: 2231:
        -: 2232:  const ecma_compiled_code_t *bytecode_data_p;
    #####: 2233:  bytecode_data_p = ecma_op_function_get_compiled_code ((ecma_extended_object_t *) object_p);
        -: 2234:
        -: 2235:#if JERRY_ESNEXT
    #####: 2236:  ecma_extended_object_t *ext_func_p = (ecma_extended_object_t *) object_p;
        -: 2237:
    #####: 2238:  if (!ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp))
        -: 2239:  {
        -: 2240:    /* Unintialized 'length' property is non-enumerable (ECMA-262 v6, 19.2.4.1) */
    #####: 2241:    ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_LENGTH));
    #####: 2242:    prop_counter_p->string_named_props++;
        -: 2243:  }
        -: 2244:
    #####: 2245:  if (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) != CBC_FUNCTION_CONSTRUCTOR
    #####: 2246:      && !ECMA_GET_SECOND_BIT_FROM_POINTER_TAG (ext_func_p->u.function.scope_cp))
        -: 2247:  {
        -: 2248:    /* Unintialized 'name' property is non-enumerable (ECMA-262 v6, 19.2.4.2) */
    #####: 2249:    ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_NAME));
    #####: 2250:    prop_counter_p->string_named_props++;
        -: 2251:  }
        -: 2252:#else /* !JERRY_ESNEXT */
        -: 2253:  /* 'length' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2254:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_LENGTH));
    #####: 2255:  prop_counter_p->string_named_props++;
        -: 2256:#endif /* JERRY_ESNEXT */
        -: 2257:
        -: 2258:#if JERRY_ESNEXT
    #####: 2259:  if (!CBC_FUNCTION_HAS_PROTOTYPE (bytecode_data_p->status_flags)
    #####: 2260:      || (CBC_FUNCTION_GET_TYPE (bytecode_data_p->status_flags) == CBC_FUNCTION_CONSTRUCTOR))
        -: 2261:  {
    #####: 2262:    return;
        -: 2263:  }
        -: 2264:
    #####: 2265:  bool append_caller_and_arguments = !(bytecode_data_p->status_flags & CBC_CODE_FLAGS_STRICT_MODE);
        -: 2266:#else /* !JERRY_ESNEXT */
    #####: 2267:  bool append_caller_and_arguments = (bytecode_data_p->status_flags & CBC_CODE_FLAGS_STRICT_MODE);
        -: 2268:#endif /* JERRY_ESNEXT */
        -: 2269:
    #####: 2270:  if (append_caller_and_arguments)
        -: 2271:  {
        -: 2272:    /* 'arguments' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2273:    ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_ARGUMENTS));
        -: 2274:
        -: 2275:    /* 'caller' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2276:    ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_CALLER));
        -: 2277:
    #####: 2278:    prop_counter_p->string_named_props += 2;
        -: 2279:  }
        -: 2280:
        -: 2281:  /* 'prototype' property is non-enumerable (ECMA-262 v5, 13.2.18) */
    #####: 2282:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_PROTOTYPE));
    #####: 2283:  prop_counter_p->string_named_props++;
        -: 2284:} /* ecma_op_function_list_lazy_property_names */
        -: 2285:
        -: 2286:/**
        -: 2287: * List names of an External Function object's lazy instantiated properties,
        -: 2288: * adding them to corresponding string collections
        -: 2289: *
        -: 2290: * See also:
        -: 2291: *          ecma_op_external_function_try_to_lazy_instantiate_property
        -: 2292: */
        -: 2293:void
    #####: 2294:ecma_op_external_function_list_lazy_property_names (ecma_object_t *object_p, /**< function object */
        -: 2295:                                                    ecma_collection_t *prop_names_p, /**< prop name collection */
        -: 2296:                                                    ecma_property_counter_t *prop_counter_p, /**< property counters */
        -: 2297:                                                    jerry_property_filter_t filter) /**< property name
        -: 2298:                                                                                     *   filter options */
        -: 2299:{
        -: 2300:  JERRY_UNUSED (object_p);
        -: 2301:
    #####: 2302:  if (filter & JERRY_PROPERTY_FILTER_EXCLUDE_STRINGS)
        -: 2303:  {
    #####: 2304:    return;
        -: 2305:  }
        -: 2306:
        -: 2307:  /* 'prototype' property is non-enumerable (ECMA-262 v5, 13.2.18) */
    #####: 2308:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_PROTOTYPE));
    #####: 2309:  prop_counter_p->string_named_props++;
        -: 2310:} /* ecma_op_external_function_list_lazy_property_names */
        -: 2311:
        -: 2312:/**
        -: 2313: * List names of a Bound Function object's lazy instantiated properties,
        -: 2314: * adding them to corresponding string collections
        -: 2315: *
        -: 2316: * See also:
        -: 2317: *          ecma_op_bound_function_try_to_lazy_instantiate_property
        -: 2318: */
        -: 2319:void
    #####: 2320:ecma_op_bound_function_list_lazy_property_names (ecma_object_t *object_p, /**< bound function object*/
        -: 2321:                                                 ecma_collection_t *prop_names_p, /**< prop name collection */
        -: 2322:                                                 ecma_property_counter_t *prop_counter_p, /**< property counters */
        -: 2323:                                                 jerry_property_filter_t filter) /**< property name filter options */
        -: 2324:{
    #####: 2325:  if (filter & JERRY_PROPERTY_FILTER_EXCLUDE_STRINGS)
        -: 2326:  {
    #####: 2327:    return;
        -: 2328:  }
        -: 2329:
        -: 2330:#if JERRY_ESNEXT
        -: 2331:  /* Unintialized 'length' property is non-enumerable (ECMA-262 v6, 19.2.4.1) */
    #####: 2332:  ecma_bound_function_t *bound_func_p = (ecma_bound_function_t *) object_p;
    #####: 2333:  if (!ECMA_GET_FIRST_BIT_FROM_POINTER_TAG (bound_func_p->header.u.bound_function.target_function))
        -: 2334:  {
    #####: 2335:    ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_LENGTH));
    #####: 2336:    prop_counter_p->string_named_props++;
        -: 2337:  }
        -: 2338:#else /* !JERRY_ESNEXT */
        -: 2339:  JERRY_UNUSED (object_p);
        -: 2340:  /* 'length' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2341:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_LENGTH));
    #####: 2342:  prop_counter_p->string_named_props++;
        -: 2343:#endif /* JERRY_ESNEXT */
        -: 2344:
        -: 2345:  /* 'caller' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2346:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_CALLER));
        -: 2347:
        -: 2348:  /* 'arguments' property is non-enumerable (ECMA-262 v5, 13.2.5) */
    #####: 2349:  ecma_collection_push_back (prop_names_p, ecma_make_magic_string_value (LIT_MAGIC_STRING_ARGUMENTS));
        -: 2350:
    #####: 2351:  prop_counter_p->string_named_props += 2;
        -: 2352:} /* ecma_op_bound_function_list_lazy_property_names */
        -: 2353:
        -: 2354:/**
        -: 2355: * @}
        -: 2356: * @}
        -: 2357: */
