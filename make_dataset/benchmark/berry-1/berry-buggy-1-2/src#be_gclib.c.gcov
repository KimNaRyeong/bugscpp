        -:    0:Source:src/be_gclib.c
        -:    0:Graph:./src/be_gclib.gcno
        -:    0:Data:./src/be_gclib.gcda
        -:    0:Runs:1
        -:    1:/********************************************************************
        -:    2:** Copyright (c) 2018-2020 Guan Wenliang
        -:    3:** This file is part of the Berry default interpreter.
        -:    4:** skiars@qq.com, https://github.com/Skiars/berry
        -:    5:** See Copyright Notice in the LICENSE file or at
        -:    6:** https://github.com/Skiars/berry/blob/master/LICENSE
        -:    7:********************************************************************/
        -:    8:#include "be_object.h"
        -:    9:#include "be_gc.h"
        -:   10:
        -:   11:#if BE_USE_GC_MODULE
        -:   12:
    #####:   13:static int m_allocated(bvm *vm)
        -:   14:{
    #####:   15:    size_t count = be_gc_memcount(vm);
    #####:   16:    if (count < 0x80000000) {
    #####:   17:        be_pushint(vm, (bint)count);
        -:   18:    } else {
    #####:   19:        be_pushreal(vm, (breal)count);
        -:   20:    }
    #####:   21:    be_return(vm);
        -:   22:}
        -:   23:
    #####:   24:static int m_collect(bvm *vm)
        -:   25:{
    #####:   26:    be_gc_collect(vm);
    #####:   27:    be_return_nil(vm);
        -:   28:}
        -:   29:
        -:   30:#if !BE_USE_PRECOMPILED_OBJECT
        -:   31:be_native_module_attr_table(gc){
        -:   32:    be_native_module_function("allocated", m_allocated),
        -:   33:    be_native_module_function("collect", m_collect)
        -:   34:};
        -:   35:
        -:   36:be_define_native_module(gc, NULL);
        -:   37:#else
        -:   38:/* @const_object_info_begin
        -:   39:module gc (scope: global, depend: BE_USE_GC_MODULE) {
        -:   40:    allocated, func(m_allocated)
        -:   41:    collect, func(m_collect)
        -:   42:}
        -:   43:@const_object_info_end */
        -:   44:#include "../generate/be_fixed_gc.h"
        -:   45:#endif
        -:   46:
        -:   47:#endif /* BE_USE_SYS_MODULE */
