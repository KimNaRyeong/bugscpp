        -:    0:Source:modules/time/time.c
        -:    0:Graph:/home/workspace/libyara/modules/time/time.gcno
        -:    0:Data:/home/workspace/libyara/modules/time/time.gcda
        -:    0:Runs:10
        -:    1:/*
        -:    2:Copyright (c) 2014-2017. The YARA Authors. All Rights Reserved.
        -:    3:
        -:    4:Redistribution and use in source and binary forms, with or without modification,
        -:    5:are permitted provided that the following conditions are met:
        -:    6:
        -:    7:1. Redistributions of source code must retain the above copyright notice, this
        -:    8:list of conditions and the following disclaimer.
        -:    9:
        -:   10:2. Redistributions in binary form must reproduce the above copyright notice,
        -:   11:this list of conditions and the following disclaimer in the documentation and/or
        -:   12:other materials provided with the distribution.
        -:   13:
        -:   14:3. Neither the name of the copyright holder nor the names of its contributors
        -:   15:may be used to endorse or promote products derived from this software without
        -:   16:specific prior written permission.
        -:   17:
        -:   18:THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
        -:   19:ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
        -:   20:WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
        -:   21:DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
        -:   22:ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
        -:   23:(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
        -:   24:LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
        -:   25:ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
        -:   26:(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
        -:   27:SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
        -:   28:*/
        -:   29:
        -:   30:#include <time.h>
        -:   31:
        -:   32:#include <yara/modules.h>
        -:   33:
        -:   34:#define MODULE_NAME time
        -:   35:
        -:   36:
    #####:   37:define_function(now)
        -:   38:{
    #####:   39:  time_t now = time(NULL);
    #####:   40:  if (now == -1)
    #####:   41:    return_integer(YR_UNDEFINED);
    #####:   42:  return_integer((long) now);
        -:   43:}
        -:   44:
        -:   45:
    #####:   46:begin_declarations;
        -:   47:
    #####:   48:  declare_function("now", "", "i", now);
        -:   49:
    #####:   50:end_declarations;
        -:   51:
        -:   52:
        6:   53:int module_initialize(
        -:   54:    YR_MODULE* module)
        -:   55:{
        6:   56:  return ERROR_SUCCESS;
        -:   57:}
        -:   58:
        -:   59:
        5:   60:int module_finalize(
        -:   61:    YR_MODULE* module)
        -:   62:{
        5:   63:  return ERROR_SUCCESS;
        -:   64:}
        -:   65:
        -:   66:
    #####:   67:int module_load(
        -:   68:    YR_SCAN_CONTEXT* context,
        -:   69:    YR_OBJECT* module_object,
        -:   70:    void* module_data,
        -:   71:    size_t module_data_size)
        -:   72:{
    #####:   73:  return ERROR_SUCCESS;
        -:   74:}
        -:   75:
        -:   76:
    #####:   77:int module_unload(
        -:   78:    YR_OBJECT* module_object)
        -:   79:{
    #####:   80:  return ERROR_SUCCESS;
        -:   81:}
